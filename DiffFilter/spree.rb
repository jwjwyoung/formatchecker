19290
target: */db/migrate/*
i 1000 i 2000 i 3000 i 4000 i 5000 i 6000 length: 11
length: 10
i 7000 length: 11
length: 11
length: 11
length: 11
length: 11
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 15
length: 13
length: 18
length: 37
length: 37
length: 13
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
i 8000 length: 39
length: 39
length: 39
length: 39
length: 39
length: 39
length: 528
length: 567
length: 567
length: 567
length: 567
length: 411
length: 361
length: 753
length: 97
length: 831
length: 357
length: 755
length: 520
length: 520
length: 22
length: 542
length: 542
length: 37
length: 542
length: 542
length: 542
length: 548
length: 548
length: 548
length: 548
length: 548
length: 548
length: 548
length: 14
length: 562
length: 562
length: 562
length: 562
length: 562
length: 562
length: 562
length: 562
length: 562
length: 562
length: 11
length: 17
length: 12
length: 602
length: 613
length: 613
length: 613
length: 613
length: 613
length: 613
length: 613
length: 613
length: 613
length: 613
length: 613
length: 11
length: 624
length: 624
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
cmd cd /Users/jwy/Research/spree/; git diff 3628cc4d195544f58ece7bc9d6a9107fec9e5aff 86f10556c3c5d0c9bd1ed83c60575b989d6283b6 */db/migrate/*
version: 3628cc4d195544f58ece7bc9d6a9107fec9e5aff vs 86f10556c3c5d0c9bd1ed83c60575b989d6283b6
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
length: 624
length: 624
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
cmd cd /Users/jwy/Research/spree/; git diff bb0351b0ef3d53ae10d6b69f5da2ee2db930aa97 da05aab9ef000ba9aa2d6cc4341dc24f7ba3e61d */db/migrate/*
version: bb0351b0ef3d53ae10d6b69f5da2ee2db930aa97 vs da05aab9ef000ba9aa2d6cc4341dc24f7ba3e61d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
length: 624
length: 624
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
cmd cd /Users/jwy/Research/spree/; git diff a1c072607d3e16a8f9439b86be128b3494d61c35 3f0228ed88d5cb9a3f9f131382fa85497c92b1ce */db/migrate/*
version: a1c072607d3e16a8f9439b86be128b3494d61c35 vs 3f0228ed88d5cb9a3f9f131382fa85497c92b1ce
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
length: 624
length: 624
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
cmd cd /Users/jwy/Research/spree/; git diff 7dc41e1554fa15f68b15346b6e34746258ce9d34 9d1cb5b0f10a43f8b6eb49621e359e37b1c2cf4d */db/migrate/*
version: 7dc41e1554fa15f68b15346b6e34746258ce9d34 vs 9d1cb5b0f10a43f8b6eb49621e359e37b1c2cf4d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
length: 84
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 1
cmd cd /Users/jwy/Research/spree/; git diff 7ddf7fee3a52e3393aa86f828ca8fb214ca734de 58ec5cd5124e66c60811a075b290248962159f9e */db/migrate/*
version: 7ddf7fee3a52e3393aa86f828ca8fb214ca734de vs 58ec5cd5124e66c60811a075b290248962159f9e
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 719
length: 719
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 2
cmd cd /Users/jwy/Research/spree/; git diff a54e08522b744c104d2a20ee2675dbe0b046fcb6 04240511a0693955d544502d94f61355173df212 */db/migrate/*
version: a54e08522b744c104d2a20ee2675dbe0b046fcb6 vs 04240511a0693955d544502d94f61355173df212
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 719
length: 719
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 2
cmd cd /Users/jwy/Research/spree/; git diff ecb88ea110c1e5a843eeb0f4e6889489e756d11a 0e033ae1aa66ca1a65d4b835df18f5122e4a9971 */db/migrate/*
version: ecb88ea110c1e5a843eeb0f4e6889489e756d11a vs 0e033ae1aa66ca1a65d4b835df18f5122e4a9971
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 719
length: 719
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 2
cmd cd /Users/jwy/Research/spree/; git diff f87812d9c33ee7f272ee2253af2f519c3002dde0 c35f4d3d3c1a4aff783d010d22a2b1275ee46f95 */db/migrate/*
version: f87812d9c33ee7f272ee2253af2f519c3002dde0 vs c35f4d3d3c1a4aff783d010d22a2b1275ee46f95
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 719
length: 719
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 2
cmd cd /Users/jwy/Research/spree/; git diff b808449788d4e5164eed7258711315b8da7e9543 5d83b7eacd1d8c93e0f881001a4f81e34e1453b6 */db/migrate/*
version: b808449788d4e5164eed7258711315b8da7e9543 vs 5d83b7eacd1d8c93e0f881001a4f81e34e1453b6
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 719
length: 719
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 2
cmd cd /Users/jwy/Research/spree/; git diff 3c9e6f18f83006dba5b76c9fd14574c7c82dec08 769c1aaae3eb3c06b5a95ee8c336552bb2c8fa42 */db/migrate/*
version: 3c9e6f18f83006dba5b76c9fd14574c7c82dec08 vs 769c1aaae3eb3c06b5a95ee8c336552bb2c8fa42
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 730
length: 730
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 2
cmd cd /Users/jwy/Research/spree/; git diff e492b69d0d8a33879252b26ff39db713f8751e83 43b7c1f0faef0a465ac477ac5d9a89b8bced59a2 */db/migrate/*
version: e492b69d0d8a33879252b26ff39db713f8751e83 vs 43b7c1f0faef0a465ac477ac5d9a89b8bced59a2
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 730
length: 730
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 2
cmd cd /Users/jwy/Research/spree/; git diff e75c43169ecfde89507a4158cc2a2899cb17fb99 38efeb35502792e84b1e18b442ac87153f3475e7 */db/migrate/*
version: e75c43169ecfde89507a4158cc2a2899cb17fb99 vs 38efeb35502792e84b1e18b442ac87153f3475e7
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 24
length: 12
length: 743
length: 743
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 369f5712a384bbef0e9d2a4c583ad7023b6fa28d 4b487d7b3727bdf43ffc8b5c74717d3bc4e7b03d */db/migrate/*
version: 369f5712a384bbef0e9d2a4c583ad7023b6fa28d vs 4b487d7b3727bdf43ffc8b5c74717d3bc4e7b03d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..7bcfd640f3
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant.price,
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 743
length: 743
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 2ff558e4caabaab274d1b3123a4f30bce25d09ff 04ff2c2d32aacc05e44c2649aff8c2e1e31a68fe */db/migrate/*
version: 2ff558e4caabaab274d1b3123a4f30bce25d09ff vs 04ff2c2d32aacc05e44c2649aff8c2e1e31a68fe
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..7bcfd640f3
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant.price,
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
i 9000 length: 15
length: 758
length: 758
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 25c74c19ab2f75fdc2359cbe5f5a357ab98098c1 12733c037688bf3f3777547f09560d8b59bc1d44 */db/migrate/*
version: 25c74c19ab2f75fdc2359cbe5f5a357ab98098c1 vs 12733c037688bf3f3777547f09560d8b59bc1d44
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..7bcfd640f3
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant.price,
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 13
length: 12
length: 11
length: 781
length: 781
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff fbd0fb62a1e876a74023a24b5d740cf11e85e5cc b17eae2475ab07094926309462cc22b2273e5322 */db/migrate/*
version: fbd0fb62a1e876a74023a24b5d740cf11e85e5cc vs b17eae2475ab07094926309462cc22b2273e5322
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 574
length: 574
length: 51
length: 15
length: 11
length: 858
length: 858
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 9ba4860c376be9b638bac47a578427c0b0309d02 13aabf412641a81d7277f52bfa89d8ed4d80cd33 */db/migrate/*
version: 9ba4860c376be9b638bac47a578427c0b0309d02 vs 13aabf412641a81d7277f52bfa89d8ed4d80cd33
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 11
length: 11
length: 40
length: 13
length: 36
length: 27
length: 12
length: 11
length: 12
length: 13
length: 15
length: 30
length: 13
length: 18
length: 30
length: 23
length: 13
length: 20
length: 11
length: 11
length: 11
length: 11
length: 13
length: 14
length: 32
length: 15
length: 11
length: 14
length: 32
length: 16
length: 18
length: 16
length: 16
length: 1322
length: 1322
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 3c512d48c6ec62074169d1d3a0a5d8108d896507 6465730f94d8ab88852b87e78f00a7d023d7f144 */db/migrate/*
version: 3c512d48c6ec62074169d1d3a0a5d8108d896507 vs 6465730f94d8ab88852b87e78f00a7d023d7f144
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1322
length: 1322
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 1acaf76bd6080493be993eabd64baba9f12eeda6 757af949348e020e64c7293d3ece0cde30e555ba */db/migrate/*
version: 1acaf76bd6080493be993eabd64baba9f12eeda6 vs 757af949348e020e64c7293d3ece0cde30e555ba
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 9
length: 9
length: 9
length: 13
length: 16
length: 16
length: 15
length: 1338
length: 1338
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff dd75642e8c483c774200b921c7601c5cba6cbada 6725f9f666e6f2e99fc1baaab006fb83defd220d */db/migrate/*
version: dd75642e8c483c774200b921c7601c5cba6cbada vs 6725f9f666e6f2e99fc1baaab006fb83defd220d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1338
length: 1338
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff a64142136ce260955da8f3e91fc7b2c058140d60 785585e392a635075558f31f874fb6de2d5fee8b */db/migrate/*
version: a64142136ce260955da8f3e91fc7b2c058140d60 vs 785585e392a635075558f31f874fb6de2d5fee8b
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1338
length: 1338
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 883e8df25a1d6486b7a2475dea8d64a3c6feb1fe c0353bb1b09e3fd877a1fcf472c13ae4e89c4688 */db/migrate/*
version: 883e8df25a1d6486b7a2475dea8d64a3c6feb1fe vs c0353bb1b09e3fd877a1fcf472c13ae4e89c4688
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1338
length: 1338
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 122019cde412e8b2a51aa63ff79e4576df8ccc52 aca50ff5d5d7317b433ff21204fa68aaea30f55d */db/migrate/*
version: 122019cde412e8b2a51aa63ff79e4576df8ccc52 vs aca50ff5d5d7317b433ff21204fa68aaea30f55d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 19
length: 1345
length: 1345
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 35480f911d2181a974d809f2fd3f3e9bf38ef45d 5da063bcc53381d3fe1a63351eba16d1a0a5638a */db/migrate/*
version: 35480f911d2181a974d809f2fd3f3e9bf38ef45d vs 5da063bcc53381d3fe1a63351eba16d1a0a5638a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1345
length: 1345
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 3f9342df631f715856bee53b17dbfcd4afc8cc34 f9e18f7d33e0512039485c84a2d615fcbe453f52 */db/migrate/*
version: 3f9342df631f715856bee53b17dbfcd4afc8cc34 vs f9e18f7d33e0512039485c84a2d615fcbe453f52
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1345
length: 1345
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff c85629a238a6e75dd5b916f563b466cfab6f9732 8fbb530c04718d669ad174ba72a9e71484fc5e9d */db/migrate/*
version: c85629a238a6e75dd5b916f563b466cfab6f9732 vs 8fbb530c04718d669ad174ba72a9e71484fc5e9d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
i 10000 length: 1345
length: 1345
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 185f9d31bf8aa2e0bb81c242880df2476a9025f3 a6227f30828c03d66aae037581ddab83a41b265a */db/migrate/*
version: 185f9d31bf8aa2e0bb81c242880df2476a9025f3 vs a6227f30828c03d66aae037581ddab83a41b265a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1345
length: 1345
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8b83f6ca64b4f2dfd846176b85a7fdf55d5dd53d 31cd6d7f17e6ce6688535d0a18ad54dd395eb479 */db/migrate/*
version: 8b83f6ca64b4f2dfd846176b85a7fdf55d5dd53d vs 31cd6d7f17e6ce6688535d0a18ad54dd395eb479
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 26
length: 1350
length: 1372
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 673b9a82064e487d522216b781b4e75242f7be8a 9f66568364e65ce8e77a5468048782b8615fc60a */db/migrate/*
version: 673b9a82064e487d522216b781b4e75242f7be8a vs 9f66568364e65ce8e77a5468048782b8615fc60a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 17
length: 20
length: 1393
length: 1393
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 18108654da58dde232ca44ee03922e1bf484b333 dc0c98a99da1a54378145dbcefe6ea48f63dea7b */db/migrate/*
version: 18108654da58dde232ca44ee03922e1bf484b333 vs dc0c98a99da1a54378145dbcefe6ea48f63dea7b
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 1404
length: 1404
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8858ac21f37f2ea28a9658bcf657bcd657bc10de 3b1e3de5452182f524168f0c4089bda034fb2efc */db/migrate/*
version: 8858ac21f37f2ea28a9658bcf657bcd657bc10de vs 3b1e3de5452182f524168f0c4089bda034fb2efc
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1404
length: 1404
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 88d59265887ee5e54961880d2e04c187da4dac67 898cdd493ef197a560532c36d1ad9e894761bda4 */db/migrate/*
version: 88d59265887ee5e54961880d2e04c187da4dac67 vs 898cdd493ef197a560532c36d1ad9e894761bda4
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 1415
length: 1415
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b025d7648ba72e5398c88da69171e2344e1127a1 3af05419086ade92c61942a90fad38af12178849 */db/migrate/*
version: b025d7648ba72e5398c88da69171e2344e1127a1 vs 3af05419086ade92c61942a90fad38af12178849
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1415
length: 1415
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff f4db1470167510a97149c767bee9d6a465e5d450 832660f563f6c1be4bbca360586be94ebe432c2a */db/migrate/*
version: f4db1470167510a97149c767bee9d6a465e5d450 vs 832660f563f6c1be4bbca360586be94ebe432c2a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1415
length: 1415
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 4780e9b2a89ae9bf6aedf46d542d7767d6ab5dbd 2c581c92b821018c5f840bef945dd2ea12c77d65 */db/migrate/*
version: 4780e9b2a89ae9bf6aedf46d542d7767d6ab5dbd vs 2c581c92b821018c5f840bef945dd2ea12c77d65
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1415
length: 1415
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 2296254e586dff781d9019fee19bf90cf0c4afc8 ecc60d5f1d14e551b4f3f789c71d37c675bc5f80 */db/migrate/*
version: 2296254e586dff781d9019fee19bf90cf0c4afc8 vs ecc60d5f1d14e551b4f3f789c71d37c675bc5f80
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 20
length: 1435
length: 1435
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 5b60ca0ae59acc87ad63761a5db4040c2b5c8c58 ca84cf357a2f1004c4a265d22e5f9a62eef3a39c */db/migrate/*
version: 5b60ca0ae59acc87ad63761a5db4040c2b5c8c58 vs ca84cf357a2f1004c4a265d22e5f9a62eef3a39c
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1435
length: 1435
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 7bc769f71f0078fef6cb15f623638cf038c56274 d281c4b57bcf2ef844eb2f80b5a830005c67ed70 */db/migrate/*
version: 7bc769f71f0078fef6cb15f623638cf038c56274 vs d281c4b57bcf2ef844eb2f80b5a830005c67ed70
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1435
length: 1435
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 1e46634624b7fd4fa92bb61f941c9b122751267e f0214f48f071e8f90f2343135617805d193f9237 */db/migrate/*
version: 1e46634624b7fd4fa92bb61f941c9b122751267e vs f0214f48f071e8f90f2343135617805d193f9237
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1435
length: 1435
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff c54150839c17681b9d97feb63f79b340f7b14c6e fa3a778295f9cd19188f7e156f90e7cb8ae81718 */db/migrate/*
version: c54150839c17681b9d97feb63f79b340f7b14c6e vs fa3a778295f9cd19188f7e156f90e7cb8ae81718
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1435
length: 1435
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8735cd83d1ff3432f695cd0863046fef95489292 eb739e553a75d4c082565ec08cd945ed4ba00150 */db/migrate/*
version: 8735cd83d1ff3432f695cd0863046fef95489292 vs eb739e553a75d4c082565ec08cd945ed4ba00150
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1435
length: 1435
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 77f59ae96afd1f272609af3a459ad30078bea283 ee29c0eea3e9328f579ec8d8dddc3388bfa33e34 */db/migrate/*
version: 77f59ae96afd1f272609af3a459ad30078bea283 vs ee29c0eea3e9328f579ec8d8dddc3388bfa33e34
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1435
length: 1435
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 0f53024e38bcd63482f1f1ac9017213ccd001e6c f8bb7b55134ce9abd2dffad1dc096524a85b6799 */db/migrate/*
version: 0f53024e38bcd63482f1f1ac9017213ccd001e6c vs f8bb7b55134ce9abd2dffad1dc096524a85b6799
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 29
length: 1464
length: 1464
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff d08a944f3f9cabe6cf7dbd1b4e28298192534e87 9b6ed13a5e7dffff4f6d8ce61fb5f409120ad806 */db/migrate/*
version: d08a944f3f9cabe6cf7dbd1b4e28298192534e87 vs 9b6ed13a5e7dffff4f6d8ce61fb5f409120ad806
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1464
length: 1464
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 79fda53302501012107e4da772b00de32bcaddb1 79f4cffdd6c9b94d3f50953ec65450665eb4fe0c */db/migrate/*
version: 79fda53302501012107e4da772b00de32bcaddb1 vs 79f4cffdd6c9b94d3f50953ec65450665eb4fe0c
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1464
length: 1464
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff c7dd002d8e66975f08ac616a0871db0c33e5f86c 8b630b446272bc547b0006955cc06648e3cfb2e7 */db/migrate/*
version: c7dd002d8e66975f08ac616a0871db0c33e5f86c vs 8b630b446272bc547b0006955cc06648e3cfb2e7
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1464
length: 1464
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 79b42a504c0fdee134a33a76b86bffacc5a7a8ea e43ff26014582d7ea2fe4b4530d1a403aed0ad9b */db/migrate/*
version: 79b42a504c0fdee134a33a76b86bffacc5a7a8ea vs e43ff26014582d7ea2fe4b4530d1a403aed0ad9b
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 1475
length: 1475
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 937237cf766ea57e4f0cbaa876db9674a030b4f4 0d10a05a419bab346600dda4a0386d72e18fec57 */db/migrate/*
version: 937237cf766ea57e4f0cbaa876db9674a030b4f4 vs 0d10a05a419bab346600dda4a0386d72e18fec57
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1475
length: 1475
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ec4ade3ed896fe1681b12cd0f0cbde607ad65c61 2501719a1e2cfc9329a4da13f565122f270e035e */db/migrate/*
version: ec4ade3ed896fe1681b12cd0f0cbde607ad65c61 vs 2501719a1e2cfc9329a4da13f565122f270e035e
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 1486
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b126fa232ec893d565ed4349debc20c57efb26ec 008ea0178f005b00223a2c3d21a110d1cc1946cc */db/migrate/*
version: b126fa232ec893d565ed4349debc20c57efb26ec vs 008ea0178f005b00223a2c3d21a110d1cc1946cc
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff d513e38fb28b96c3638f5a04f8503747efd6e635 5e55ec81d20bb4ed5cb6a6434692ff2a60c029b3 */db/migrate/*
version: d513e38fb28b96c3638f5a04f8503747efd6e635 vs 5e55ec81d20bb4ed5cb6a6434692ff2a60c029b3
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff de68cbe992aecb88e1f7ee0d6e14bed80278aac5 dfebf09d58f588ebaf5bab1e9bae84325c13c342 */db/migrate/*
version: de68cbe992aecb88e1f7ee0d6e14bed80278aac5 vs dfebf09d58f588ebaf5bab1e9bae84325c13c342
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff bb02aa3c2141df050a0cca67b1b44c67f700bf0a a003836212ab03be5ff9f414e14dc1ad89f2c021 */db/migrate/*
version: bb02aa3c2141df050a0cca67b1b44c67f700bf0a vs a003836212ab03be5ff9f414e14dc1ad89f2c021
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 31be3016a241f7d38cf5f50eb0a2c844e3b33c0f 25bfa44128ec9aae6875d7c678df2eff5165a620 */db/migrate/*
version: 31be3016a241f7d38cf5f50eb0a2c844e3b33c0f vs 25bfa44128ec9aae6875d7c678df2eff5165a620
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8093f377402e280f33f0b80158b69c2f8f619f69 d0447eb800c36040ac67ef497307a87e7eca1c84 */db/migrate/*
version: 8093f377402e280f33f0b80158b69c2f8f619f69 vs d0447eb800c36040ac67ef497307a87e7eca1c84
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff d8ae9172c863d8a2d98ce2b3c06136ffc2d0063e 16393d72816494d04e90807ee259c0ebadf01a49 */db/migrate/*
version: d8ae9172c863d8a2d98ce2b3c06136ffc2d0063e vs 16393d72816494d04e90807ee259c0ebadf01a49
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 99c4fb86b5144279bbb7e108030d02020ae8084d 333007c8018360227cce34f17a96cc4772f9b5af */db/migrate/*
version: 99c4fb86b5144279bbb7e108030d02020ae8084d vs 333007c8018360227cce34f17a96cc4772f9b5af
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 1a18ad8eaaa28e87bc326abc6f14197290ede2e9 a6af01cda56d2fb9907704f92975770c00df281e */db/migrate/*
version: 1a18ad8eaaa28e87bc326abc6f14197290ede2e9 vs a6af01cda56d2fb9907704f92975770c00df281e
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff d13b39cba7fb3ebb71ca2e93767b55c7e98574ee 16da3d413adc7ed97ff24e75b0f934a023d2b7fd */db/migrate/*
version: d13b39cba7fb3ebb71ca2e93767b55c7e98574ee vs 16da3d413adc7ed97ff24e75b0f934a023d2b7fd
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 591bc0931ae753f5e7844337fe64509c8de1baa6 932c65705cd9654103549b38811b07945a2da630 */db/migrate/*
version: 591bc0931ae753f5e7844337fe64509c8de1baa6 vs 932c65705cd9654103549b38811b07945a2da630
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ec89702343cf851f2d69c5a038847a22d0bf75c0 1c50363ae075e4aaa0cf8bb9e3ebcdb0df704c91 */db/migrate/*
version: ec89702343cf851f2d69c5a038847a22d0bf75c0 vs 1c50363ae075e4aaa0cf8bb9e3ebcdb0df704c91
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 551237bb5a9a7d1f093af9c04b2d6eabb8b495f9 418dda8f79ed3623fa96e0dbedc4def88bf8cea4 */db/migrate/*
version: 551237bb5a9a7d1f093af9c04b2d6eabb8b495f9 vs 418dda8f79ed3623fa96e0dbedc4def88bf8cea4
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 234cd6c0c0746b34301bcc4a3082cfa16db84fc1 63214854463583423ac3ec72620b28914a535df2 */db/migrate/*
version: 234cd6c0c0746b34301bcc4a3082cfa16db84fc1 vs 63214854463583423ac3ec72620b28914a535df2
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff c12df8c564479e689cf550eef3645da37c118571 e09735c622326b2f2e14ee2c3de212145eb83894 */db/migrate/*
version: c12df8c564479e689cf550eef3645da37c118571 vs e09735c622326b2f2e14ee2c3de212145eb83894
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff c19d5baab113d90db606819b348514ef8f114079 5751bb98dff67382f82dba3554a6bc4a25dc71cd */db/migrate/*
version: c19d5baab113d90db606819b348514ef8f114079 vs 5751bb98dff67382f82dba3554a6bc4a25dc71cd
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 684b8a06170bf7bae412c5747295e2c296752884 230c0bf692b59d648c543c5441d55080ce38b6c6 */db/migrate/*
version: 684b8a06170bf7bae412c5747295e2c296752884 vs 230c0bf692b59d648c543c5441d55080ce38b6c6
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 17c7825ecc9870fb5aa3c60bbf986fbb0a4711aa 264b3e626e14da0ce2856140db4bdccc886b5f19 */db/migrate/*
version: 17c7825ecc9870fb5aa3c60bbf986fbb0a4711aa vs 264b3e626e14da0ce2856140db4bdccc886b5f19
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1497
length: 1497
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 9ef4a66cd841876c719a46b7a7e81359b122d3bd 82ad4db2f5dd5225a15feac11479d4425b643a1e */db/migrate/*
version: 9ef4a66cd841876c719a46b7a7e81359b122d3bd vs 82ad4db2f5dd5225a15feac11479d4425b643a1e
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 11
length: 1519
length: 1519
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 603a2a5c2c2e5c56f09b9eeeac75b610078b8f9e 50d6ed1230c92cd216581f0a4b53bdbdc154753a */db/migrate/*
version: 603a2a5c2c2e5c56f09b9eeeac75b610078b8f9e vs 50d6ed1230c92cd216581f0a4b53bdbdc154753a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1519
length: 1519
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 2975a2e27148ebb60f9c020dee6e8bd029f2bbd0 1d5591999ae71ac17ba520a07449688509fe9262 */db/migrate/*
version: 2975a2e27148ebb60f9c020dee6e8bd029f2bbd0 vs 1d5591999ae71ac17ba520a07449688509fe9262
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1519
length: 1519
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 848ad1d455d0ad8fb50b9bcbe5ba1b2bce719ccc b7912d4099c8ece0e4a7e4acdf8d4a0e30ef5e7f */db/migrate/*
version: 848ad1d455d0ad8fb50b9bcbe5ba1b2bce719ccc vs b7912d4099c8ece0e4a7e4acdf8d4a0e30ef5e7f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 16
length: 15
length: 15
length: 1552
length: 1552
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ca49035f10218996aeccb0a4c5786d4505a66a6a d61969cb2057d7daf58fcece3fef3c7c35d385e2 */db/migrate/*
version: ca49035f10218996aeccb0a4c5786d4505a66a6a vs d61969cb2057d7daf58fcece3fef3c7c35d385e2
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1552
length: 1552
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 1a8e9e2b569318fb9fb763dd448d0593f8ece286 56bea27165819d6ee773950146e2ef7c45e6d227 */db/migrate/*
version: 1a8e9e2b569318fb9fb763dd448d0593f8ece286 vs 56bea27165819d6ee773950146e2ef7c45e6d227
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 12
length: 1564
length: 1564
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 3ea2acc7a70c849192ae1dd43d12d4f7973852ce 91747f1484f1567c322d5f03c38a7b798af0228c */db/migrate/*
version: 3ea2acc7a70c849192ae1dd43d12d4f7973852ce vs 91747f1484f1567c322d5f03c38a7b798af0228c
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1564
length: 1564
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 9d2a456dfc98be6e908e6158233b20efedee8632 e2990ee40f62461e297e3ba2a2ebde7118c63179 */db/migrate/*
version: 9d2a456dfc98be6e908e6158233b20efedee8632 vs e2990ee40f62461e297e3ba2a2ebde7118c63179
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 24
length: 1588
length: 1588
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 43e064b6e32671a7e6d6fd178dea295cb0555646 b398908f461ec653a068a29ad5df63273d1fc0b6 */db/migrate/*
version: 43e064b6e32671a7e6d6fd178dea295cb0555646 vs b398908f461ec653a068a29ad5df63273d1fc0b6
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1588
length: 1588
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 59b405c81b45ab7677a71963dc92037034420bb8 bdd4db95eb2cce3e87f3991dbeca22e275862fc3 */db/migrate/*
version: 59b405c81b45ab7677a71963dc92037034420bb8 vs bdd4db95eb2cce3e87f3991dbeca22e275862fc3
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1588
length: 1588
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8ed05f9392b7d60ebd12e481981b950bcbb691c9 42c607cd81bef358f565f2bd772e7396c67cfc4e */db/migrate/*
version: 8ed05f9392b7d60ebd12e481981b950bcbb691c9 vs 42c607cd81bef358f565f2bd772e7396c67cfc4e
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1588
length: 1588
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 68d2f74625a5e12fc14d679a07b8421faff24059 9033092612b3e2e0e82c1b49d07221ad9c80e975 */db/migrate/*
version: 68d2f74625a5e12fc14d679a07b8421faff24059 vs 9033092612b3e2e0e82c1b49d07221ad9c80e975
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 18
length: 1593
length: 1593
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 6f6b6d7ba41047f3e68f1fa0c4e3a3c0aa4961e3 47a091aceb321ce0679f5f1cccc77781228e0301 */db/migrate/*
version: 6f6b6d7ba41047f3e68f1fa0c4e3a3c0aa4961e3 vs 47a091aceb321ce0679f5f1cccc77781228e0301
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1593
length: 1593
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff abad518a1620c19f0791f0de15fef87ec453716f 65316f6a384637f089830d187383e85b325c86b2 */db/migrate/*
version: abad518a1620c19f0791f0de15fef87ec453716f vs 65316f6a384637f089830d187383e85b325c86b2
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1593
length: 1593
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 823be86f3b7b6aec52585addbf375b72e783f194 7132d775494c3e1fc85ed21b1b0549a668d1c665 */db/migrate/*
version: 823be86f3b7b6aec52585addbf375b72e783f194 vs 7132d775494c3e1fc85ed21b1b0549a668d1c665
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1593
length: 1593
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 52dfb32ffd6470bd14b5a489aeb2b9526cbd1c0b 224317464ae95df6bc1491b4f6ec5097afbd8d6f */db/migrate/*
version: 52dfb32ffd6470bd14b5a489aeb2b9526cbd1c0b vs 224317464ae95df6bc1491b4f6ec5097afbd8d6f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1593
length: 1593
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 0152ac26cc63b39c4b36392d6564eea457dfe1af 07f8e103536d9501a27fb5e154f35e0aaaf01984 */db/migrate/*
version: 0152ac26cc63b39c4b36392d6564eea457dfe1af vs 07f8e103536d9501a27fb5e154f35e0aaaf01984
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 1604
length: 1604
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 1cf130a1bb380e43f570a3763ffce1203ff23460 794abd7cd5c7c68fba340c83863bcd793b9cbce1 */db/migrate/*
version: 1cf130a1bb380e43f570a3763ffce1203ff23460 vs 794abd7cd5c7c68fba340c83863bcd793b9cbce1
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1604
length: 1604
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff d44269e6a8c74a4aa2a20ddf3bda93db0c51ce5e 09b55f7be8720f0d6d16822f4ce23c961d1c66f5 */db/migrate/*
version: d44269e6a8c74a4aa2a20ddf3bda93db0c51ce5e vs 09b55f7be8720f0d6d16822f4ce23c961d1c66f5
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1604
length: 1604
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff a13421aafc991ed50df3e757cfb0d11bfe0f15df 2e8ad0f1295b1f9efe60556a0d36f5e550e9ed1f */db/migrate/*
version: a13421aafc991ed50df3e757cfb0d11bfe0f15df vs 2e8ad0f1295b1f9efe60556a0d36f5e550e9ed1f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1604
length: 1604
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 26d22aa063b261219f5da736de84e76d238ee80c 7b943cc6f7f5905bc4b319034cabd90f27ae9cbe */db/migrate/*
version: 26d22aa063b261219f5da736de84e76d238ee80c vs 7b943cc6f7f5905bc4b319034cabd90f27ae9cbe
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1604
length: 1604
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 1c8a3165a5b04fa32c28b951e346e70b05a21ed0 6bd09ffa564f38e21f904ae2b3e2727f0911b826 */db/migrate/*
version: 1c8a3165a5b04fa32c28b951e346e70b05a21ed0 vs 6bd09ffa564f38e21f904ae2b3e2727f0911b826
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1604
length: 1604
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff cdc706dbf8b08971e42f8427d9b363bd0646f1c8 abf3ec811707e25a69b3ac822335d64e30c4673c */db/migrate/*
version: cdc706dbf8b08971e42f8427d9b363bd0646f1c8 vs abf3ec811707e25a69b3ac822335d64e30c4673c
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1604
length: 1604
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff f436f93b9431c0aaf8dde0ea5d38fb0b4a93ecfb 6ff655269916607f00feef75dbdbfd8fa482f83c */db/migrate/*
version: f436f93b9431c0aaf8dde0ea5d38fb0b4a93ecfb vs 6ff655269916607f00feef75dbdbfd8fa482f83c
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 12
length: 1616
i 11000 length: 1616
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8c62be8cdba7d81fda5d1262e2b382eae0378720 c9404f631a4f42bfc45e03f38e74971098b465b2 */db/migrate/*
version: 8c62be8cdba7d81fda5d1262e2b382eae0378720 vs c9404f631a4f42bfc45e03f38e74971098b465b2
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1616
length: 1616
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff e91ed69a43480b649c20f3e6380d3d5b4286c9b1 601e2d41e57c33b3a26132aab26ab1bd53c7ba29 */db/migrate/*
version: e91ed69a43480b649c20f3e6380d3d5b4286c9b1 vs 601e2d41e57c33b3a26132aab26ab1bd53c7ba29
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1616
length: 1616
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff f78b06099bc186758c93e9069874836752eac88f a96f72ea312eda7d96de2a539bd22add653191f3 */db/migrate/*
version: f78b06099bc186758c93e9069874836752eac88f vs a96f72ea312eda7d96de2a539bd22add653191f3
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1616
length: 1616
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ff9052dc7ddac81e27e9b8c15d47799fa19e142a 69f82a717ff8d646ac8c286add9390bcfea5153e */db/migrate/*
version: ff9052dc7ddac81e27e9b8c15d47799fa19e142a vs 69f82a717ff8d646ac8c286add9390bcfea5153e
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1616
length: 1616
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff fd68cdcaa2ecc00e8372c43f5db05df084330268 04fb28aae88a000df9e7d0e10c51776f002f63dc */db/migrate/*
version: fd68cdcaa2ecc00e8372c43f5db05df084330268 vs 04fb28aae88a000df9e7d0e10c51776f002f63dc
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1616
length: 1616
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b254eafc0e38d433ccdee89b187129c749086dcf 3e48d602c55fa377658df5e9cea2b9d019647e84 */db/migrate/*
version: b254eafc0e38d433ccdee89b187129c749086dcf vs 3e48d602c55fa377658df5e9cea2b9d019647e84
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1616
length: 1616
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 35d1d56904de7a9ea80b4af6c9f076ad50a063c7 a9b1470d036edf1c14da210afca13602f39021df */db/migrate/*
version: 35d1d56904de7a9ea80b4af6c9f076ad50a063c7 vs a9b1470d036edf1c14da210afca13602f39021df
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 12
length: 11
length: 1639
length: 1639
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 2434ef1963aad7eb7a28cc364136b9fc2a07b4da ab27eb7d0d953b3943ac1a6407dd6121579d2794 */db/migrate/*
version: 2434ef1963aad7eb7a28cc364136b9fc2a07b4da vs ab27eb7d0d953b3943ac1a6407dd6121579d2794
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1639
length: 1639
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 3d5edd8c02733666700247587e934edc6840344e 2d31d8a69d66e2555e00f67e3227a54a531aa6b8 */db/migrate/*
version: 3d5edd8c02733666700247587e934edc6840344e vs 2d31d8a69d66e2555e00f67e3227a54a531aa6b8
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1639
length: 1639
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 7773dc4f3b1878aa4a25a0c7092bf83470ef618b c6d58ca950797aef89676bf38c197c87cadba5c3 */db/migrate/*
version: 7773dc4f3b1878aa4a25a0c7092bf83470ef618b vs c6d58ca950797aef89676bf38c197c87cadba5c3
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1639
length: 1650
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 12e3686d2c41e3c5e73dd6935a7912607b97c940 d67167e7d97c67ad3f4777f9b804911ddac8df53 */db/migrate/*
version: 12e3686d2c41e3c5e73dd6935a7912607b97c940 vs d67167e7d97c67ad3f4777f9b804911ddac8df53
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1650
length: 1650
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 12899c25d5c4f4c02a943a41f827eaed58d57fd0 7a5e43662c57807dafaebf8160069e4de8f1c855 */db/migrate/*
version: 12899c25d5c4f4c02a943a41f827eaed58d57fd0 vs 7a5e43662c57807dafaebf8160069e4de8f1c855
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 1661
length: 1661
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 4b564732eb5239f726c749c5e2d7e52aba2a21a0 11282e14a5d029fcd7089d9ef3add4425e9e5189 */db/migrate/*
version: 4b564732eb5239f726c749c5e2d7e52aba2a21a0 vs 11282e14a5d029fcd7089d9ef3add4425e9e5189
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1661
length: 1661
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff eb9af6052b30d82a1670e7979995f94a691e79fb 1b91cede281fbdbd3b2fcf7f6f2c50915c8e36df */db/migrate/*
version: eb9af6052b30d82a1670e7979995f94a691e79fb vs 1b91cede281fbdbd3b2fcf7f6f2c50915c8e36df
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 1672
length: 1672
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 10fa8d56e0cf7718a652f53f8028d4fcd0a7bb08 60d0b1f5554a2d49281ca180ec7ba055c286231c */db/migrate/*
version: 10fa8d56e0cf7718a652f53f8028d4fcd0a7bb08 vs 60d0b1f5554a2d49281ca180ec7ba055c286231c
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 15
length: 14
length: 13
length: 1701
length: 1701
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 228eef96dcde69ea5fb59fb95d0000a9390bd02c 4be89d3daa7073a8b2133b2c8b9420da6226758b */db/migrate/*
version: 228eef96dcde69ea5fb59fb95d0000a9390bd02c vs 4be89d3daa7073a8b2133b2c8b9420da6226758b
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1701
length: 1701
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 39e01f8873f2364717a76a81b8ee0c0c2a6c998a 5f611e65a61ace92d46fcc88c053cc73de135638 */db/migrate/*
version: 39e01f8873f2364717a76a81b8ee0c0c2a6c998a vs 5f611e65a61ace92d46fcc88c053cc73de135638
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 18
length: 1719
length: 1719
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b32347670265d29fd0ffb3ac95c592526212c000 d7a3362d16574159af80f47b655f3e63ddab588a */db/migrate/*
version: b32347670265d29fd0ffb3ac95c592526212c000 vs d7a3362d16574159af80f47b655f3e63ddab588a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1719
length: 1719
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 91b2ab342eb215b63681da0984b7866d91713ce8 f02d25566d42f06d2ceea596ff9823d5ad06da67 */db/migrate/*
version: 91b2ab342eb215b63681da0984b7866d91713ce8 vs f02d25566d42f06d2ceea596ff9823d5ad06da67
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1719
length: 1719
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 569ddd8c2cd6c41fce22b2e1f72729c23c8f6262 4059a35c41e492f9056ddd38e82b4affa314c8a0 */db/migrate/*
version: 569ddd8c2cd6c41fce22b2e1f72729c23c8f6262 vs 4059a35c41e492f9056ddd38e82b4affa314c8a0
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1719
length: 1734
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff f97d1be0f6bcb31dad47c49e7eb9855bce646504 388c867519be02bb443c091a5c80d77f626c3fd0 */db/migrate/*
version: f97d1be0f6bcb31dad47c49e7eb9855bce646504 vs 388c867519be02bb443c091a5c80d77f626c3fd0
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1734
length: 1734
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 523eb67f4fd8edf004c87d7d13c446b8f09455c8 25d65a42f1284f35caf31f99ed62a2048f55a0cb */db/migrate/*
version: 523eb67f4fd8edf004c87d7d13c446b8f09455c8 vs 25d65a42f1284f35caf31f99ed62a2048f55a0cb
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 11
length: 1756
length: 1756
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff e7733540ebf86fa01aafd9749fb970a538907be4 98fbe2de9f2c96fcbaeba3b198c5148f1fa57924 */db/migrate/*
version: e7733540ebf86fa01aafd9749fb970a538907be4 vs 98fbe2de9f2c96fcbaeba3b198c5148f1fa57924
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1756
length: 1756
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff d8a0ac85d9851a869c13ec97b723f65b92aac5b1 826f405c8e18f09e2373c3987fae89944e301b01 */db/migrate/*
version: d8a0ac85d9851a869c13ec97b723f65b92aac5b1 vs 826f405c8e18f09e2373c3987fae89944e301b01
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 14
length: 1757
length: 1757
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 9e7011529de0961cb7093508f25a577ae6d95809 0944a8fc9031b907f4feaa5cd6097c1567d46d42 */db/migrate/*
version: 9e7011529de0961cb7093508f25a577ae6d95809 vs 0944a8fc9031b907f4feaa5cd6097c1567d46d42
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1757
length: 1757
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 1628ae9c29cb1191eff92dd6e26fd1ddc2609b82 32bcb64414e802b3dc56ca300a441164db731873 */db/migrate/*
version: 1628ae9c29cb1191eff92dd6e26fd1ddc2609b82 vs 32bcb64414e802b3dc56ca300a441164db731873
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1757
length: 1757
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff db103492284bd3d5623aa19865be3a3267f44b8b c3da7d8c2a4a2b57ce0c2d55838497dcc9dd88fa */db/migrate/*
version: db103492284bd3d5623aa19865be3a3267f44b8b vs c3da7d8c2a4a2b57ce0c2d55838497dcc9dd88fa
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1757
length: 1757
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 9491ef6ae96487a6e2ad8648fd9b1ad2396da843 7bd0f808a0c104c9d1fb26af9113b6dd3a55e3d7 */db/migrate/*
version: 9491ef6ae96487a6e2ad8648fd9b1ad2396da843 vs 7bd0f808a0c104c9d1fb26af9113b6dd3a55e3d7
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1757
length: 1757
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 04d7814ec66c590781374672f5b4b1e139446405 eca921ade6392740e490b1b536aa40432f511754 */db/migrate/*
version: 04d7814ec66c590781374672f5b4b1e139446405 vs eca921ade6392740e490b1b536aa40432f511754
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1757
length: 1757
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8221eb2fc44242ed47f7cefbb8805f325694514f 30261ec2703be133c1f08e99a4b8d437da757a69 */db/migrate/*
version: 8221eb2fc44242ed47f7cefbb8805f325694514f vs 30261ec2703be133c1f08e99a4b8d437da757a69
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1757
length: 1757
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 79b7ec564fd9350c374c456dd76ec4d166acab32 14b2e25bf9a5d5b281066998e5a749b03d9a2237 */db/migrate/*
version: 79b7ec564fd9350c374c456dd76ec4d166acab32 vs 14b2e25bf9a5d5b281066998e5a749b03d9a2237
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1757
length: 1757
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 9b1516c572bb5fa1074c619ac1acfd9e4a3983e7 9fbf5e64eee3fba224871913856d306b04c8fdae */db/migrate/*
version: 9b1516c572bb5fa1074c619ac1acfd9e4a3983e7 vs 9fbf5e64eee3fba224871913856d306b04c8fdae
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1757
length: 1757
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 4e1ea1d66770b4dd9ac8da8bd7c5fb47f15bc27e 3de99e271204fbcf235805ca13643109e49a7459 */db/migrate/*
version: 4e1ea1d66770b4dd9ac8da8bd7c5fb47f15bc27e vs 3de99e271204fbcf235805ca13643109e49a7459
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1757
length: 1757
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ff37b70e4177f592344cecc2087e054a0bb0a4ed 4c1cdb0880386323d7878f3bd41af21e0cb641a5 */db/migrate/*
version: ff37b70e4177f592344cecc2087e054a0bb0a4ed vs 4c1cdb0880386323d7878f3bd41af21e0cb641a5
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1757
length: 1757
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 1b5a2a2c7c5b81e3c6be73fbf651c80014330701 dcb94e92ce5e2d61c05ecf36d9d29b03df974830 */db/migrate/*
version: 1b5a2a2c7c5b81e3c6be73fbf651c80014330701 vs dcb94e92ce5e2d61c05ecf36d9d29b03df974830
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 22
length: 1779
length: 1779
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 343b5ee28ffe597c88e157be72c175322d1aaaae 6aee7a1a95cf258559db2b6a93bee50c47c5ffcc */db/migrate/*
version: 343b5ee28ffe597c88e157be72c175322d1aaaae vs 6aee7a1a95cf258559db2b6a93bee50c47c5ffcc
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1779
length: 1779
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b02571742b0076bf6941d5aaa1157a4322cf5831 d3fb3ca7219e907630c736afc8855b48d2f88d04 */db/migrate/*
version: b02571742b0076bf6941d5aaa1157a4322cf5831 vs d3fb3ca7219e907630c736afc8855b48d2f88d04
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1779
length: 1779
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b81a0c781a4618edfb9d98c53d3c0c75f744a1f6 89ad9de95b0359cf8cec0e3dcc9803ed1cd19e48 */db/migrate/*
version: b81a0c781a4618edfb9d98c53d3c0c75f744a1f6 vs 89ad9de95b0359cf8cec0e3dcc9803ed1cd19e48
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1779
length: 1779
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ea5b44496a211084039a4f5004db4286dcec9998 6231889d8b261e96f36bcc451158147ebd8f7c85 */db/migrate/*
version: ea5b44496a211084039a4f5004db4286dcec9998 vs 6231889d8b261e96f36bcc451158147ebd8f7c85
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1779
length: 1779
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ccca80c2402976d06d7955bd0b59045c73631145 ea00ee7bfe811ca87d5938ec32ee8e39196e2e38 */db/migrate/*
version: ccca80c2402976d06d7955bd0b59045c73631145 vs ea00ee7bfe811ca87d5938ec32ee8e39196e2e38
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1779
length: 1779
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 4f73a7160bac42997f2ae7a06f2d5d5d865f57a0 a425a1bb7c362b141ed6442b51508edc182f8516 */db/migrate/*
version: 4f73a7160bac42997f2ae7a06f2d5d5d865f57a0 vs a425a1bb7c362b141ed6442b51508edc182f8516
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1779
length: 1779
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8ae81187a82ce6ab4303d017fd75cb04bcf0d244 104123f1862ab2d479088c32d7e561415c3d4d0b */db/migrate/*
version: 8ae81187a82ce6ab4303d017fd75cb04bcf0d244 vs 104123f1862ab2d479088c32d7e561415c3d4d0b
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1779
length: 1779
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 4237cb0f7422eb33d34098c1f001d32f9571b85b 6cb6688a052cc1fc6fc09e7be119109ed9420493 */db/migrate/*
version: 4237cb0f7422eb33d34098c1f001d32f9571b85b vs 6cb6688a052cc1fc6fc09e7be119109ed9420493
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1779
length: 1779
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff a70b5edd3ab0762cd1a6981c4bb04fc9a65176b7 1be697eb001ad42723c75b826ea1cb08f1dd37ac */db/migrate/*
version: a70b5edd3ab0762cd1a6981c4bb04fc9a65176b7 vs 1be697eb001ad42723c75b826ea1cb08f1dd37ac
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1779
length: 1790
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 667ea59860cf1d33de4f48004a5f078aa2e31727 e05aa2f85c9ee4a1ee36017545027f341cba873b */db/migrate/*
version: 667ea59860cf1d33de4f48004a5f078aa2e31727 vs e05aa2f85c9ee4a1ee36017545027f341cba873b
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1790
length: 1790
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff c2d197c9f8a5ba248d7c3c2f20d7aec0c5c42f69 7eb9caac7025d88371a2266c4cab99fe930263bf */db/migrate/*
version: c2d197c9f8a5ba248d7c3c2f20d7aec0c5c42f69 vs 7eb9caac7025d88371a2266c4cab99fe930263bf
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1790
length: 1790
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8cba29565b613f0b7be9c477e92e2cbd82b96615 cfac57a5c2f57226cd4d3441c66ec5fcc68bc9b2 */db/migrate/*
version: 8cba29565b613f0b7be9c477e92e2cbd82b96615 vs cfac57a5c2f57226cd4d3441c66ec5fcc68bc9b2
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1790
length: 1790
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 5fc361c98c712e54295501ffd3b0a3072132978d 2410ed29fb5fd3c6758b77bb32830e14aba2fa7a */db/migrate/*
version: 5fc361c98c712e54295501ffd3b0a3072132978d vs 2410ed29fb5fd3c6758b77bb32830e14aba2fa7a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1790
length: 1790
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 263bbb523e922fec01a483938e4796e6a469b37f 4dd308bcd81b389d59ad4f97a43379eb5588dd67 */db/migrate/*
version: 263bbb523e922fec01a483938e4796e6a469b37f vs 4dd308bcd81b389d59ad4f97a43379eb5588dd67
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1790
length: 1790
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 6b1dec5a8edce12d16144b00d8dd2ea785c61ace 2a5363218309d5784c6cc463a7aad5564e880066 */db/migrate/*
version: 6b1dec5a8edce12d16144b00d8dd2ea785c61ace vs 2a5363218309d5784c6cc463a7aad5564e880066
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1790
length: 1790
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 584ca1d117d368f39b4da5390d38b9a5543be79c 6cfb55a663fd1ca163055cf41c601933c012bfc4 */db/migrate/*
version: 584ca1d117d368f39b4da5390d38b9a5543be79c vs 6cfb55a663fd1ca163055cf41c601933c012bfc4
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1790
length: 1790
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 43ba8ae099ede911d5506906fdddf555d12c61dc 5d25143c33e1a450b9a7c19f642031263ec60975 */db/migrate/*
version: 43ba8ae099ede911d5506906fdddf555d12c61dc vs 5d25143c33e1a450b9a7c19f642031263ec60975
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 15
length: 14
length: 11
length: 11
length: 11
length: 11
length: 13
length: 11
length: 11
length: 13
length: 1911
length: 1911
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b5a97eccf9368073f7ac1f6b2019f9b6aedd6ac9 97c20c3db40ee6786eba635d2d9828fbc091917d */db/migrate/*
version: b5a97eccf9368073f7ac1f6b2019f9b6aedd6ac9 vs 97c20c3db40ee6786eba635d2d9828fbc091917d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1911
length: 1911
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff a4e9af00174a233460da0b41a2202eb9b1084fdb 62996bb0e246cdadca58530be97f807626827c57 */db/migrate/*
version: a4e9af00174a233460da0b41a2202eb9b1084fdb vs 62996bb0e246cdadca58530be97f807626827c57
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1911
length: 1911
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff e47fdfc37cd747d03be2498b51e6a4329ea910d7 1b9db399bf7fcd05b6a079984277944d2f4c9f5f */db/migrate/*
version: e47fdfc37cd747d03be2498b51e6a4329ea910d7 vs 1b9db399bf7fcd05b6a079984277944d2f4c9f5f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
i 12000 length: 1911
length: 1911
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 97633be58daaca3f35655cc6e6c94b735ac99711 f4ee2d68ff4643b92e2014f3404f97d20a8540d4 */db/migrate/*
version: 97633be58daaca3f35655cc6e6c94b735ac99711 vs f4ee2d68ff4643b92e2014f3404f97d20a8540d4
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 18
length: 19
length: 1937
length: 1937
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff a049e7ca35edc556e80a21a8c9e737d1d53f183a 7955e9ba4fbc109056f4fc15f28db751049c4ace */db/migrate/*
version: a049e7ca35edc556e80a21a8c9e737d1d53f183a vs 7955e9ba4fbc109056f4fc15f28db751049c4ace
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1937
length: 1937
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 1a57f12c077d6c0521a10c4c2c57d14b06587b08 1eb9e4979401f5c4401fc40741c5f19e3e9c3b80 */db/migrate/*
version: 1a57f12c077d6c0521a10c4c2c57d14b06587b08 vs 1eb9e4979401f5c4401fc40741c5f19e3e9c3b80
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1937
length: 1978
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 134bb4224ab1ba80f550a9f276cb5b8f5edcdec4 2949ac7437de0157fcbdebe28bf9616951b7ca33 */db/migrate/*
version: 134bb4224ab1ba80f550a9f276cb5b8f5edcdec4 vs 2949ac7437de0157fcbdebe28bf9616951b7ca33
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1978
length: 1978
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff af330c3f84aba97d5ebda1eefe7c1bdd14f5658a cd7105b063fe6e73b6e462705c1167d6d66c1a6d */db/migrate/*
version: af330c3f84aba97d5ebda1eefe7c1bdd14f5658a vs cd7105b063fe6e73b6e462705c1167d6d66c1a6d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1978
length: 1978
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff e5ac97fbf14da57c1b1dae412e0cc54897e64b98 0d76a2121c9549823c4cd0b6d4c751b4094375ca */db/migrate/*
version: e5ac97fbf14da57c1b1dae412e0cc54897e64b98 vs 0d76a2121c9549823c4cd0b6d4c751b4094375ca
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 1978
length: 1978
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b62a04047a4db64e2c3a1b52fdf99ff3f0ab4e71 bc6310a184ebe3d03868406f821195df789fee8f */db/migrate/*
version: b62a04047a4db64e2c3a1b52fdf99ff3f0ab4e71 vs bc6310a184ebe3d03868406f821195df789fee8f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 13
length: 12
length: 46
length: 14
length: 14
length: 24
length: 2035
length: 2035
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff f4395c8bc39f8b0fc7aa07fa6b1d4136a8dd58f8 a21f64b831b6ad9edf8ad33b8e8936bfd886669c */db/migrate/*
version: f4395c8bc39f8b0fc7aa07fa6b1d4136a8dd58f8 vs a21f64b831b6ad9edf8ad33b8e8936bfd886669c
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2035
length: 2035
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 7824505363c349b38b08ed5ae0825777531c3353 b28b4ede14e4712266feab9ab57829915a5e82c8 */db/migrate/*
version: 7824505363c349b38b08ed5ae0825777531c3353 vs b28b4ede14e4712266feab9ab57829915a5e82c8
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2035
length: 2035
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 9b2be2ba47bf28d01916cd387e46f0350823e6ac 61b1d2d9abeff425f34808867a128a4f8694240c */db/migrate/*
version: 9b2be2ba47bf28d01916cd387e46f0350823e6ac vs 61b1d2d9abeff425f34808867a128a4f8694240c
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2035
length: 2030
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 3c136e7cf5687a67eb23d0d0ffd68bce49a128f5 79964283200d687687bcdb7454911e9343fe7acc */db/migrate/*
version: 3c136e7cf5687a67eb23d0d0ffd68bce49a128f5 vs 79964283200d687687bcdb7454911e9343fe7acc
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2030
length: 2030
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8af846fb2857e82b254d4fd745f862356f3b49ad 1730926c9ddb122cb55c7269e9ef46f8942c31ab */db/migrate/*
version: 8af846fb2857e82b254d4fd745f862356f3b49ad vs 1730926c9ddb122cb55c7269e9ef46f8942c31ab
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 17
length: 2032
length: 2032
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8bcfb192c3792160006e947ad88717978362b86d 966525c95ec387a26244eb10466b91c41fa578ad */db/migrate/*
version: 8bcfb192c3792160006e947ad88717978362b86d vs 966525c95ec387a26244eb10466b91c41fa578ad
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2032
length: 2032
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 9859626b7de209ef71956ca8cb264d7ac9b47b48 8236b35cee218f5a3ccb6beafa1672b9778a667c */db/migrate/*
version: 9859626b7de209ef71956ca8cb264d7ac9b47b48 vs 8236b35cee218f5a3ccb6beafa1672b9778a667c
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2032
length: 2032
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 58b6f2c866a2a5aa3534ced335d147de59d54235 c582576e9c3a6474174e0b11a0b856e4fc3808ce */db/migrate/*
version: 58b6f2c866a2a5aa3534ced335d147de59d54235 vs c582576e9c3a6474174e0b11a0b856e4fc3808ce
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2032
length: 2032
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 492ae036fe762a2700c6a0dd744068fc0bc33fbc b0378f5f73927d40a34acb8777b004957588e1aa */db/migrate/*
version: 492ae036fe762a2700c6a0dd744068fc0bc33fbc vs b0378f5f73927d40a34acb8777b004957588e1aa
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2032
length: 2032
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 57012c3372f4f2b7337c317719c6e7110c94f5d6 4ced61c3746ab8507e9e8d49c9de94d1a3a3c7aa */db/migrate/*
version: 57012c3372f4f2b7337c317719c6e7110c94f5d6 vs 4ced61c3746ab8507e9e8d49c9de94d1a3a3c7aa
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 13
length: 2045
length: 2045
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 639f3808d48b959e24d3e5fec029e1203b67c044 d36374ea1c40ea793af3e12cab013518e25ce16f */db/migrate/*
version: 639f3808d48b959e24d3e5fec029e1203b67c044 vs d36374ea1c40ea793af3e12cab013518e25ce16f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2045
length: 2045
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 6d6653ca8f7caec26b97f0b8b16f9237e13576a2 19589a9484c74f3e485c068dcb70aa4e94a3de5d */db/migrate/*
version: 6d6653ca8f7caec26b97f0b8b16f9237e13576a2 vs 19589a9484c74f3e485c068dcb70aa4e94a3de5d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2045
length: 2045
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff dad52445eec6c637e9ee8c641e822f057f46db73 057c6084003bbf2ddc2a6814bf07abd172cb66e3 */db/migrate/*
version: dad52445eec6c637e9ee8c641e822f057f46db73 vs 057c6084003bbf2ddc2a6814bf07abd172cb66e3
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2045
length: 2045
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ceaf1c2822a6e0da77d3a258ac1fe5d3e4b7d353 0ecc44d745c5e0b573171ae5eea3dc2a5249baee */db/migrate/*
version: ceaf1c2822a6e0da77d3a258ac1fe5d3e4b7d353 vs 0ecc44d745c5e0b573171ae5eea3dc2a5249baee
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2045
length: 2045
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 021c47d107a7bcab04e32e676437b135f487daf0 23dca8b92a1c5b91e85fb295fc384f35b3e1dbe4 */db/migrate/*
version: 021c47d107a7bcab04e32e676437b135f487daf0 vs 23dca8b92a1c5b91e85fb295fc384f35b3e1dbe4
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2045
length: 2045
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff aa3a6e13cf122be900e819a06691614162f8882c 2d541aead449fc1496bd194c4ffe2e2386bd1ac5 */db/migrate/*
version: aa3a6e13cf122be900e819a06691614162f8882c vs 2d541aead449fc1496bd194c4ffe2e2386bd1ac5
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2045
length: 2045
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 03aba1c0b22c74c79c0a42e7441139069076bfe4 524ab2ba39b2c5d10dba90488ecf018139620750 */db/migrate/*
version: 03aba1c0b22c74c79c0a42e7441139069076bfe4 vs 524ab2ba39b2c5d10dba90488ecf018139620750
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2045
length: 2045
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 573c174b483d478e7d80ccacedd65a88d5c9dd4c 0a861e8b92ff9b6afb99a5a604cc15f6925e95c9 */db/migrate/*
version: 573c174b483d478e7d80ccacedd65a88d5c9dd4c vs 0a861e8b92ff9b6afb99a5a604cc15f6925e95c9
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2045
length: 2045
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 75f74e9a152385acc3da9779fbc22d3c1937ebd2 2e1335873ff7bb8468b21d4b11d8f74bc2ba4dab */db/migrate/*
version: 75f74e9a152385acc3da9779fbc22d3c1937ebd2 vs 2e1335873ff7bb8468b21d4b11d8f74bc2ba4dab
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 2056
length: 2056
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 9f7470c40b94db8817e8d3b734d5871bc702d4ce f00671658acc504d6b634cd8400d2aecf65f7a9e */db/migrate/*
version: 9f7470c40b94db8817e8d3b734d5871bc702d4ce vs f00671658acc504d6b634cd8400d2aecf65f7a9e
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2056
length: 2056
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8ea9e0691e732dbed1e3a39d6697d5f71ace991f b7c06668d84002efa433d08007320e831683d48f */db/migrate/*
version: 8ea9e0691e732dbed1e3a39d6697d5f71ace991f vs b7c06668d84002efa433d08007320e831683d48f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2056
length: 2056
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 00ac1536b44dc7d176fdc72741c6cbd96280a311 27db20b98d2160c1d0d3aee2ec18ee379669af41 */db/migrate/*
version: 00ac1536b44dc7d176fdc72741c6cbd96280a311 vs 27db20b98d2160c1d0d3aee2ec18ee379669af41
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 12
length: 13
length: 11
length: 17
length: 2097
length: 2097
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 79a39e9e18969f7e2855d4efc089d439233dfddc 31d88b84a52be765f14b5b90f5f70c9fc1478d0d */db/migrate/*
version: 79a39e9e18969f7e2855d4efc089d439233dfddc vs 31d88b84a52be765f14b5b90f5f70c9fc1478d0d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 11
length: 25
length: 13
length: 2144
length: 2144
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff a60bb96bb56454416908ed0b6ac6f6de9240f4ac 3e525fd1cc917cc9d56cad952ce39818284b46ad */db/migrate/*
version: a60bb96bb56454416908ed0b6ac6f6de9240f4ac vs 3e525fd1cc917cc9d56cad952ce39818284b46ad
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 2155
length: 2155
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b40b7f983ce83de0a185883a9549cb2beca8c691 edd5b6015fdcb6bbe3c4769256cb63e37a3524d1 */db/migrate/*
version: b40b7f983ce83de0a185883a9549cb2beca8c691 vs edd5b6015fdcb6bbe3c4769256cb63e37a3524d1
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 30
length: 13
length: 13
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 6745d976c9e8187f213960468e590a181558d9c6 a318b71e598c9fdf21f0c287bbbadaf8ab07220f */db/migrate/*
version: 6745d976c9e8187f213960468e590a181558d9c6 vs a318b71e598c9fdf21f0c287bbbadaf8ab07220f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 905bb12653400afad87b269e763a6f127e344c51 74bcfdd7879e431d4e681fe5fa2985c228745ead */db/migrate/*
version: 905bb12653400afad87b269e763a6f127e344c51 vs 74bcfdd7879e431d4e681fe5fa2985c228745ead
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b3ffaec6e78ebf83993c432b433e91b5aa6bcc9e 32d614705c6a68916def28969830ac494c0e9c54 */db/migrate/*
version: b3ffaec6e78ebf83993c432b433e91b5aa6bcc9e vs 32d614705c6a68916def28969830ac494c0e9c54
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff c1615181fef73e7c43bf4d8281d5c686f50172f4 7c09878dff7c574102452808cef148ec9ff76e50 */db/migrate/*
version: c1615181fef73e7c43bf4d8281d5c686f50172f4 vs 7c09878dff7c574102452808cef148ec9ff76e50
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff fe64705a35adfe0bce171c325b301371397c019d bdeeed88f29808434eac6aa5028e8c935ad31d8a */db/migrate/*
version: fe64705a35adfe0bce171c325b301371397c019d vs bdeeed88f29808434eac6aa5028e8c935ad31d8a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8fe879ad7096e389c9c23048ce619d8e0b1c6531 4e10c9a25553f84ede2877fdd5a4ef22d19ca64a */db/migrate/*
version: 8fe879ad7096e389c9c23048ce619d8e0b1c6531 vs 4e10c9a25553f84ede2877fdd5a4ef22d19ca64a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ade5e3b4c82a58e4b04c61799ee19341bd72b654 49b1e85a13eee8363000b47fb579321f3da4eaa3 */db/migrate/*
version: ade5e3b4c82a58e4b04c61799ee19341bd72b654 vs 49b1e85a13eee8363000b47fb579321f3da4eaa3
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff be7ebe2905b0369302d6a4c0e373453946b70cf6 a4792abf6e202af97143d6cbec719c001c1e8140 */db/migrate/*
version: be7ebe2905b0369302d6a4c0e373453946b70cf6 vs a4792abf6e202af97143d6cbec719c001c1e8140
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 262d0402d28febfc8d1b94ee900b1c0fa705ea76 2be96fb0667544b1473bb7b8dc563e1228e99259 */db/migrate/*
version: 262d0402d28febfc8d1b94ee900b1c0fa705ea76 vs 2be96fb0667544b1473bb7b8dc563e1228e99259
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ab6898c2782dd005ceec32a22324fc910bd72c1e d3469a6ec18649d52cbced07c3c476d09ab5e2ba */db/migrate/*
version: ab6898c2782dd005ceec32a22324fc910bd72c1e vs d3469a6ec18649d52cbced07c3c476d09ab5e2ba
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 6459e449cce80918dd9aee703c3e4e83d3b7dab7 8a3af763a393af5f2cfd7697d9c18e1c1a99714c */db/migrate/*
version: 6459e449cce80918dd9aee703c3e4e83d3b7dab7 vs 8a3af763a393af5f2cfd7697d9c18e1c1a99714c
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 73a97f57f7622b393a5e7c2da48b672fbd1a8f46 6854f98021690a40bcca0702a9081717d3742843 */db/migrate/*
version: 73a97f57f7622b393a5e7c2da48b672fbd1a8f46 vs 6854f98021690a40bcca0702a9081717d3742843
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2185
length: 2185
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 4dd11420780446824a055c08fd9ab147cff7fca2 81672b617515e3be4897cd20cd33d5aabbb79a4f */db/migrate/*
version: 4dd11420780446824a055c08fd9ab147cff7fca2 vs 81672b617515e3be4897cd20cd33d5aabbb79a4f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 30
length: 14
length: 2229
length: 2229
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 0ec6631ec84ed1e5a0774c0643cac276265a115f b25e5a6b16801ff1a7b2ea25dbc713680b7965e7 */db/migrate/*
version: 0ec6631ec84ed1e5a0774c0643cac276265a115f vs b25e5a6b16801ff1a7b2ea25dbc713680b7965e7
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2229
length: 2229
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff d1ccd0476986fd70b9b17adb0998d24f792a8f95 fff8ea9e1676360988421dc4ae2cba38c6f8fb16 */db/migrate/*
version: d1ccd0476986fd70b9b17adb0998d24f792a8f95 vs fff8ea9e1676360988421dc4ae2cba38c6f8fb16
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2229
length: 2229
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff aefea4c24d928e54657203b2e65f3a1be634bc89 3516aa39c903faeca1d18746bfeefc7b138b1cae */db/migrate/*
version: aefea4c24d928e54657203b2e65f3a1be634bc89 vs 3516aa39c903faeca1d18746bfeefc7b138b1cae
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2229
length: 2229
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 408540b94ec428f5a856573aa23aa98d378ed1c5 4f1ff9f876381c21ab0b5c0120a3cc7a751cdf16 */db/migrate/*
version: 408540b94ec428f5a856573aa23aa98d378ed1c5 vs 4f1ff9f876381c21ab0b5c0120a3cc7a751cdf16
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2229
length: 2229
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b35c33e3482d7ade5f241d99d9a901f3dcacaa4e ec3c1f41e67bb174b6a9ac5e289e58856e6966a4 */db/migrate/*
version: b35c33e3482d7ade5f241d99d9a901f3dcacaa4e vs ec3c1f41e67bb174b6a9ac5e289e58856e6966a4
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2229
length: 2229
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b5091341f999b44aaba3351072a10f1c0e84a001 aeaa6f46b2872b3d7e70948120bf2fac85ad7f01 */db/migrate/*
version: b5091341f999b44aaba3351072a10f1c0e84a001 vs aeaa6f46b2872b3d7e70948120bf2fac85ad7f01
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2229
length: 2229
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 99dae4c1ec0b1f4cbabfe4f9fd5e531fc63d0ec0 d82eed6267ca20eeb1abab67764384b21a537f0b */db/migrate/*
version: 99dae4c1ec0b1f4cbabfe4f9fd5e531fc63d0ec0 vs d82eed6267ca20eeb1abab67764384b21a537f0b
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2229
length: 2240
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8e7c0b499c9415e749513a66edbc3bf57c0a548d dcbf76d8179dd8308f6b0c67887d42ae5b727cc8 */db/migrate/*
version: 8e7c0b499c9415e749513a66edbc3bf57c0a548d vs dcbf76d8179dd8308f6b0c67887d42ae5b727cc8
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2240
length: 2240
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 6772b6fec30302a48e598ed94bb25d0cd6beb1a8 d8f326289079cb45112772b4fd2df54f229b4ec3 */db/migrate/*
version: 6772b6fec30302a48e598ed94bb25d0cd6beb1a8 vs d8f326289079cb45112772b4fd2df54f229b4ec3
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2240
length: 2240
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8d2f9cdb0efcb4f2976763b2be0bc8df73693ff7 0afd39147c675fb1026a2227381f7d526d7b9840 */db/migrate/*
version: 8d2f9cdb0efcb4f2976763b2be0bc8df73693ff7 vs 0afd39147c675fb1026a2227381f7d526d7b9840
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 20
length: 2242
length: 2242
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 58e1e4462789def29260ee51a063326bbb2e47d2 4741a4f21bdd3520351e3b135b71cdadd7c54685 */db/migrate/*
version: 58e1e4462789def29260ee51a063326bbb2e47d2 vs 4741a4f21bdd3520351e3b135b71cdadd7c54685
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 17
length: 2245
length: 2256
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 3302e2c23d04c24224cb9431195a67a304f9de4f 60af63c00d6ad74c2bad280f0073c281192f85bd */db/migrate/*
version: 3302e2c23d04c24224cb9431195a67a304f9de4f vs 60af63c00d6ad74c2bad280f0073c281192f85bd
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2256
length: 2256
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 56355feb73e642a5d4ae363356ef82dd2c5ee698 f2a659859244e53f67f4c8b4f466f748a2c94fe0 */db/migrate/*
version: 56355feb73e642a5d4ae363356ef82dd2c5ee698 vs f2a659859244e53f67f4c8b4f466f748a2c94fe0
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2256
length: 2256
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 314211061eba0527572737b2d6ef3abb0262d6d2 220e14c1bc8780cb8ef138f18fbdcd149b7bc17a */db/migrate/*
version: 314211061eba0527572737b2d6ef3abb0262d6d2 vs 220e14c1bc8780cb8ef138f18fbdcd149b7bc17a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2256
length: 2256
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff be9f84749840345984b9287879bac600abbd6423 7168b2af7a09d2ddd5a5bd68c3e315fb6f590c49 */db/migrate/*
version: be9f84749840345984b9287879bac600abbd6423 vs 7168b2af7a09d2ddd5a5bd68c3e315fb6f590c49
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 12
length: 2268
length: 2268
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff cbb7a1404d92fc34043eb3688de1047abd9cff33 314adccbd31fa9793626250cdab857bb6660d0de */db/migrate/*
version: cbb7a1404d92fc34043eb3688de1047abd9cff33 vs 314adccbd31fa9793626250cdab857bb6660d0de
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 11
length: 2290
length: 2290
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 1e8dd52431b13d65b8807acedfe17143372f2770 30597b2aa7a1f47b5e636750baf7c100f0cc42b2 */db/migrate/*
version: 1e8dd52431b13d65b8807acedfe17143372f2770 vs 30597b2aa7a1f47b5e636750baf7c100f0cc42b2
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2290
length: 2290
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 82319ab92f46ba8da5ec64f8f9b55ef25220d533 0c9a743ed46d505edb8489727873902a42d92756 */db/migrate/*
version: 82319ab92f46ba8da5ec64f8f9b55ef25220d533 vs 0c9a743ed46d505edb8489727873902a42d92756
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2290
length: 2290
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 6ccb85798cb54f5eabb6fe6433b7347b89c17eb3 b50998a6bc8b4467e78fb044d3404bf3ac74402f */db/migrate/*
version: 6ccb85798cb54f5eabb6fe6433b7347b89c17eb3 vs b50998a6bc8b4467e78fb044d3404bf3ac74402f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 18
length: 13
length: 11
length: 2319
length: 2330
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff c2ca05ca7c74fa37e2dcf3ad8768d3ca0502b719 f40272a143c19af4b3fb3641ab48ebb5c897c48e */db/migrate/*
version: c2ca05ca7c74fa37e2dcf3ad8768d3ca0502b719 vs f40272a143c19af4b3fb3641ab48ebb5c897c48e
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 25
length: 2334
length: 2334
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 00d421a114ba8bcde0401b3c98380db0c5d8241e 4cc30f97b5418b2b0bbd1e7b4e7ae5cdd5e98c39 */db/migrate/*
version: 00d421a114ba8bcde0401b3c98380db0c5d8241e vs 4cc30f97b5418b2b0bbd1e7b4e7ae5cdd5e98c39
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2334
length: 2334
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff f1f5948967723eb8413ae498bd8f8e862b35856b 1f5d4bdade641be7327aa9538d271dcefcc82f56 */db/migrate/*
version: f1f5948967723eb8413ae498bd8f8e862b35856b vs 1f5d4bdade641be7327aa9538d271dcefcc82f56
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 23
length: 11
length: 17
length: 2385
length: 2405
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff f54a2ec96f4c8a035822473e7bdbc356a1125450 68b58990e01867ef654927d9c6aa530ee8323f13 */db/migrate/*
version: f54a2ec96f4c8a035822473e7bdbc356a1125450 vs 68b58990e01867ef654927d9c6aa530ee8323f13
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 15
length: 2404
length: 2404
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 6e1af5899b2eed026ff30c6ec8181c70a6168b5e da71cb7f456f9a140b111e408c8a81d26a070f8e */db/migrate/*
version: 6e1af5899b2eed026ff30c6ec8181c70a6168b5e vs da71cb7f456f9a140b111e408c8a81d26a070f8e
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 22
length: 12
length: 11
i 13000 length: 2449
length: 2449
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff c90e64813ee3e98533213209c78429aa1f49f741 cb0c365bcb05306abd06aa3ab75cf93a9c8974f4 */db/migrate/*
version: c90e64813ee3e98533213209c78429aa1f49f741 vs cb0c365bcb05306abd06aa3ab75cf93a9c8974f4
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2449
length: 2449
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff a14652371eaae3b73677aa21bd711502c657dbce 3c0277cdb5e6c142d6279c22d784cdc0e3cbcd43 */db/migrate/*
version: a14652371eaae3b73677aa21bd711502c657dbce vs 3c0277cdb5e6c142d6279c22d784cdc0e3cbcd43
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2449
length: 2449
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 4adfc440a4edd451b8cb2443420923d5819f3b6e f7374089b2c4e15a79944e0c84ce61eb0d67cad8 */db/migrate/*
version: 4adfc440a4edd451b8cb2443420923d5819f3b6e vs f7374089b2c4e15a79944e0c84ce61eb0d67cad8
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2449
length: 2449
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 1bbb498bfb50354a7e414e3571149df1f737349e 4363dd6d79483f0bf31e3fd95cd2b4caa7410e25 */db/migrate/*
version: 1bbb498bfb50354a7e414e3571149df1f737349e vs 4363dd6d79483f0bf31e3fd95cd2b4caa7410e25
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2449
length: 2449
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 707d810a3895cacf65113859880eb6060534ddbb 9663dcdc9f313205da7f02a8268596b5e05afd92 */db/migrate/*
version: 707d810a3895cacf65113859880eb6060534ddbb vs 9663dcdc9f313205da7f02a8268596b5e05afd92
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2449
length: 2449
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 17ad56e36b8eaaaea304644a5259a4456e008f03 e4a612c115ff2f03fea0943f2babde51a633cf8b */db/migrate/*
version: 17ad56e36b8eaaaea304644a5259a4456e008f03 vs e4a612c115ff2f03fea0943f2babde51a633cf8b
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2449
length: 2449
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 922010a467d4215d83b6ebfee22b505cbd613cfc 7654107c2482779ef77c31f7958933bf17d87ac9 */db/migrate/*
version: 922010a467d4215d83b6ebfee22b505cbd613cfc vs 7654107c2482779ef77c31f7958933bf17d87ac9
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2449
length: 2449
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 32c3ae7565bba140e8cf24113149bb5d4b33619e d47ef55f6d47642bae4efaef4637555e72884d6b */db/migrate/*
version: 32c3ae7565bba140e8cf24113149bb5d4b33619e vs d47ef55f6d47642bae4efaef4637555e72884d6b
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2449
length: 2449
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 96baf69c241cda9daec10d043b488379d2bd7f9e e51e498148207ce77df1fc9a23f13312893dd4e0 */db/migrate/*
version: 96baf69c241cda9daec10d043b488379d2bd7f9e vs e51e498148207ce77df1fc9a23f13312893dd4e0
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 14
length: 14
length: 29
length: 2506
length: 2506
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8b9e42a5b9da4b482f1f21df15415cac5e221a79 0da26b685b177bfd01540c6a725ddaec050f4e0f */db/migrate/*
version: 8b9e42a5b9da4b482f1f21df15415cac5e221a79 vs 0da26b685b177bfd01540c6a725ddaec050f4e0f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 19
length: 12
length: 2537
length: 2537
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 5d22a7f319b366f0a1603a322f0f803e28112904 5e999d0249b4ebfb1981242bcdad0b30011ab0b8 */db/migrate/*
version: 5d22a7f319b366f0a1603a322f0f803e28112904 vs 5e999d0249b4ebfb1981242bcdad0b30011ab0b8
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2537
length: 2537
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 4477486ec7acf1a5348294d5e5496c4f46e3846c 0553a1e7e2b6cf52a19cf84e0ffbfdce18f502f9 */db/migrate/*
version: 4477486ec7acf1a5348294d5e5496c4f46e3846c vs 0553a1e7e2b6cf52a19cf84e0ffbfdce18f502f9
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2537
length: 2537
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 0b41e4a5d214af2b2a219878d9043a36e02c44d5 84e76b110a2b70a5f70909bd06c32f0f3133b4cc */db/migrate/*
version: 0b41e4a5d214af2b2a219878d9043a36e02c44d5 vs 84e76b110a2b70a5f70909bd06c32f0f3133b4cc
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 25
length: 22
length: 13
length: 17
length: 22
length: 2535
length: 2535
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 27f7b4485b9938528b5211f05b3ccbc949698318 a1e048065c00448186790d52c89be4cc9f137d0e */db/migrate/*
version: 27f7b4485b9938528b5211f05b3ccbc949698318 vs a1e048065c00448186790d52c89be4cc9f137d0e
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2535
length: 2535
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 42311dbba9dafa72d00b0a61c151977f2c4f108a 015df776e91f7ff64d8d4fa2acaf561c6f648e37 */db/migrate/*
version: 42311dbba9dafa72d00b0a61c151977f2c4f108a vs 015df776e91f7ff64d8d4fa2acaf561c6f648e37
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2535
length: 2535
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff d657e904e5613882b33e0f6a5b263c6e895c3dcb 73364bfde6f1a0316c2d9c8d692d471087f878e4 */db/migrate/*
version: d657e904e5613882b33e0f6a5b263c6e895c3dcb vs 73364bfde6f1a0316c2d9c8d692d471087f878e4
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2535
length: 2535
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff a902ab9c0dc43bcf6dc34adcdae64987547ed314 213484d4a3058a91ac0f2a6b9561c4b496abee1f */db/migrate/*
version: a902ab9c0dc43bcf6dc34adcdae64987547ed314 vs 213484d4a3058a91ac0f2a6b9561c4b496abee1f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 21
length: 23
length: 33
length: 40
length: 41
length: 53
length: 13
length: 2616
length: 2616
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 959d16cd9a69972e8b597ec0776d787b031db138 aa1930015689e26b9a2dbd0a1afd25ea9d143e56 */db/migrate/*
version: 959d16cd9a69972e8b597ec0776d787b031db138 vs aa1930015689e26b9a2dbd0a1afd25ea9d143e56
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2616
length: 2616
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 919840b8129eba4cd88838ffc118ae90ec6ec4a3 67894bea99087f89da1f0833a31113f07d969aaa */db/migrate/*
version: 919840b8129eba4cd88838ffc118ae90ec6ec4a3 vs 67894bea99087f89da1f0833a31113f07d969aaa
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2616
length: 2616
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 7523989199a9d3591784b1508116515211883c5d e3237b82b3c7c009b9e38d390d1bef57bcc8a7f9 */db/migrate/*
version: 7523989199a9d3591784b1508116515211883c5d vs e3237b82b3c7c009b9e38d390d1bef57bcc8a7f9
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2616
length: 2616
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ef46a93af18f7f1768291590009bd2796a4234d2 6c1adcee6937e5764284ba1b2e082d4cb3cf738d */db/migrate/*
version: ef46a93af18f7f1768291590009bd2796a4234d2 vs 6c1adcee6937e5764284ba1b2e082d4cb3cf738d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 24
length: 72
length: 2712
length: 2712
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ddd5701d1de93b2c9f331041d83f1c21a3affe15 901f15f2c7cecf0aeda19c58b08ba77c58044417 */db/migrate/*
version: ddd5701d1de93b2c9f331041d83f1c21a3affe15 vs 901f15f2c7cecf0aeda19c58b08ba77c58044417
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2712
length: 2712
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b1a1c39d8464713d5e38e1669fde0d76b7e01f18 08ceb07eacd0c7220eba930fc53f090f8a6e12b8 */db/migrate/*
version: b1a1c39d8464713d5e38e1669fde0d76b7e01f18 vs 08ceb07eacd0c7220eba930fc53f090f8a6e12b8
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2712
length: 2712
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 5cc880d22e8f44ce6289f694c8d59ad7abc6f890 600812d062746026a84e358160df2ecd1ce4baf6 */db/migrate/*
version: 5cc880d22e8f44ce6289f694c8d59ad7abc6f890 vs 600812d062746026a84e358160df2ecd1ce4baf6
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 28
length: 2724
length: 2724
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 682896909f83d2b2827b44029e564a3409316055 0c2857ea814fd128d12b1a4977d6f828539958d8 */db/migrate/*
version: 682896909f83d2b2827b44029e564a3409316055 vs 0c2857ea814fd128d12b1a4977d6f828539958d8
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2724
length: 2724
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b6d6d56fd65c09fce8d65770d0c0d84066d5692f 878801f00ec1fe0a994a3840c7da4de37ba28fd0 */db/migrate/*
version: b6d6d56fd65c09fce8d65770d0c0d84066d5692f vs 878801f00ec1fe0a994a3840c7da4de37ba28fd0
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2724
length: 2724
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff bb01f7e291e01606ee20dd95b41f7bbf59a08ee9 9bdd4e3d4b0a90c7280d46675320f03fbdd1ac68 */db/migrate/*
version: bb01f7e291e01606ee20dd95b41f7bbf59a08ee9 vs 9bdd4e3d4b0a90c7280d46675320f03fbdd1ac68
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2724
length: 2724
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 0882de1a74334a9386ecc16c63967d09c59ed408 333d1bb4a9fd517078bd2e8f7ec8cbd72c25a9c5 */db/migrate/*
version: 0882de1a74334a9386ecc16c63967d09c59ed408 vs 333d1bb4a9fd517078bd2e8f7ec8cbd72c25a9c5
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 28
length: 2723
length: 2723
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b438fee221aea44d4389b219c9da4c0a3ce8ae58 9db4c867121c939e941556e069ef9b443a5b31d8 */db/migrate/*
version: b438fee221aea44d4389b219c9da4c0a3ce8ae58 vs 9db4c867121c939e941556e069ef9b443a5b31d8
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2723
length: 2723
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff ff1dc078b2bc5697af7a64229d8656f21918e085 3ce47f7c636c56d0890ea87187c8e54629664944 */db/migrate/*
version: ff1dc078b2bc5697af7a64229d8656f21918e085 vs 3ce47f7c636c56d0890ea87187c8e54629664944
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2723
length: 2723
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b80caad1cb3cf64ecdc9d389ef1456cf2c94e1a6 fc1c6eae2974d1cb2f2a25a58e687e32ed36bc08 */db/migrate/*
version: b80caad1cb3cf64ecdc9d389ef1456cf2c94e1a6 vs fc1c6eae2974d1cb2f2a25a58e687e32ed36bc08
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2723
length: 2723
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff f59ab2fa3561a6b77a0ecea4e8e24c2a61118a34 798fcc99156932f6350fe7df9f627e259521f22f */db/migrate/*
version: f59ab2fa3561a6b77a0ecea4e8e24c2a61118a34 vs 798fcc99156932f6350fe7df9f627e259521f22f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2723
length: 2723
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 9c3dd1517d3569d7308168d7c210c6ca6a41e033 715311656d14f5ff7cfe9e837f8998721496c8f4 */db/migrate/*
version: 9c3dd1517d3569d7308168d7c210c6ca6a41e033 vs 715311656d14f5ff7cfe9e837f8998721496c8f4
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2723
length: 2723
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 3cdc5c997fe3cf6bd6d508071f1cc693cec9e209 d3b9346eac0027bb34a14fcd31ffa7d1d83a5902 */db/migrate/*
version: 3cdc5c997fe3cf6bd6d508071f1cc693cec9e209 vs d3b9346eac0027bb34a14fcd31ffa7d1d83a5902
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2723
length: 2723
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 0b99004f7174c362d5d54b7507219bca30d11dad 6035f45ceadc0f085b064410319a01be98169191 */db/migrate/*
version: 0b99004f7174c362d5d54b7507219bca30d11dad vs 6035f45ceadc0f085b064410319a01be98169191
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 14
length: 13
length: 2737
length: 2737
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 170b607cb656151536c555e45648cd715f12129f 71d4deed1aa815a2727357f2c35e2f544f5f1959 */db/migrate/*
version: 170b607cb656151536c555e45648cd715f12129f vs 71d4deed1aa815a2727357f2c35e2f544f5f1959
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 11
length: 2737
length: 2737
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b82d2d3a489a665521e33303ca7b888c9b7b61ba 0bd5d5d4ff41218026d41e6f5e57034ad4add363 */db/migrate/*
version: b82d2d3a489a665521e33303ca7b888c9b7b61ba vs 0bd5d5d4ff41218026d41e6f5e57034ad4add363
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2737
length: 2737
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 435d3c7d489da90eca40682cf4226576e638e557 b2a2da9b86be189622894cd14c33888ea53dde3a */db/migrate/*
version: 435d3c7d489da90eca40682cf4226576e638e557 vs b2a2da9b86be189622894cd14c33888ea53dde3a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2737
length: 2737
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 67e860f7cf18bfc1f31f54e064c8aa72219994e0 6e92fe67429e547419073462d1abb39b884d7a60 */db/migrate/*
version: 67e860f7cf18bfc1f31f54e064c8aa72219994e0 vs 6e92fe67429e547419073462d1abb39b884d7a60
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 18
length: 2755
length: 2755
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 376e5d2705142e4e1d7aa61b251e4d444f110637 3585dd69b6f2cab874ed0b168948df838079a1a3 */db/migrate/*
version: 376e5d2705142e4e1d7aa61b251e4d444f110637 vs 3585dd69b6f2cab874ed0b168948df838079a1a3
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 12
length: 2767
length: 2767
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 478852072342ad227ed031f46970865e3dd33978 1da26f07c9391fe102a2e983fccc5002751ebeac */db/migrate/*
version: 478852072342ad227ed031f46970865e3dd33978 vs 1da26f07c9391fe102a2e983fccc5002751ebeac
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 15
length: 46
length: 35
length: 2811
length: 2811
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 25ce10ce9eab76ddcbe2c156e588499e07cf0cef 47b710a1bee61f137d15e8c207d22170265f9aa5 */db/migrate/*
version: 25ce10ce9eab76ddcbe2c156e588499e07cf0cef vs 47b710a1bee61f137d15e8c207d22170265f9aa5
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 12
length: 2834
length: 2834
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8dff4ee7648c7701b5437f0f7ac0f0ef321eeda1 60fefe1b9af5fa1951c4de927dedaa9f2e550ed9 */db/migrate/*
version: 8dff4ee7648c7701b5437f0f7ac0f0ef321eeda1 vs 60fefe1b9af5fa1951c4de927dedaa9f2e550ed9
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2834
length: 2834
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff be726ab20cdc92a4cd2b726de22e1492ca45bfa5 c7f6c2fe0c8777cd71aff7f2ba567d34ff430602 */db/migrate/*
version: be726ab20cdc92a4cd2b726de22e1492ca45bfa5 vs c7f6c2fe0c8777cd71aff7f2ba567d34ff430602
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 20
length: 2836
length: 2836
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff d483a14b477e90b4937c85cf05017e971fba0057 b07c6c16246da77226fe7819c5ab27089d2160a7 */db/migrate/*
version: d483a14b477e90b4937c85cf05017e971fba0057 vs b07c6c16246da77226fe7819c5ab27089d2160a7
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2836
length: 2836
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 65e31be8a0a24af675fa7a6dd031438c7efda999 539ef7f723d79437d9ae14a88867d55fdc03a1f0 */db/migrate/*
version: 65e31be8a0a24af675fa7a6dd031438c7efda999 vs 539ef7f723d79437d9ae14a88867d55fdc03a1f0
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2836
length: 2836
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 8db549b637bdd6f074ff5c6b5a6953cbc3249f1d 680f225733c772d348d5c38d94ff1761a8e78f59 */db/migrate/*
version: 8db549b637bdd6f074ff5c6b5a6953cbc3249f1d vs 680f225733c772d348d5c38d94ff1761a8e78f59
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2836
length: 2836
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff a1395bef23dd48e2c02a0b97ec9d750fb8ae141d 610ed908b724da3ef8e51f16e2da32fdfa45ed7c */db/migrate/*
version: a1395bef23dd48e2c02a0b97ec9d750fb8ae141d vs 610ed908b724da3ef8e51f16e2da32fdfa45ed7c
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2836
length: 2836
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff bdf728f286f261d9914ebd94caefe0a4d63b0535 b2bca2adf78ec221083a2f06ce2a9aa0630f20cd */db/migrate/*
version: bdf728f286f261d9914ebd94caefe0a4d63b0535 vs b2bca2adf78ec221083a2f06ce2a9aa0630f20cd
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2836
length: 2834
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 787a3014719988ea29b6a82b755687e38ca2c419 681a966f2ed3a5c51b6490dcfc1c6713a8eeb415 */db/migrate/*
version: 787a3014719988ea29b6a82b755687e38ca2c419 vs 681a966f2ed3a5c51b6490dcfc1c6713a8eeb415
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 20
length: 18
length: 2854
length: 2854
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff c60ba585dead8bd70e10dfebb773e1c066bf293c c1d44b1f23d9ddfee77549eed1b62ff8fb55df2f */db/migrate/*
version: c60ba585dead8bd70e10dfebb773e1c066bf293c vs c1d44b1f23d9ddfee77549eed1b62ff8fb55df2f
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2854
length: 2912
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 146f19e8d61d9f841d3ccf9c8defdd94137b09d8 a8b51afb8e33a98b116eb88940ce0bde0aeec4be */db/migrate/*
version: 146f19e8d61d9f841d3ccf9c8defdd94137b09d8 vs a8b51afb8e33a98b116eb88940ce0bde0aeec4be
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2912
length: 2912
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 7b8d0e7097d87aee4bb9b15a690f83123d1c41ad 9f9ad070aa28fddcc4caecb9090778528d41ee40 */db/migrate/*
version: 7b8d0e7097d87aee4bb9b15a690f83123d1c41ad vs 9f9ad070aa28fddcc4caecb9090778528d41ee40
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2912
length: 2912
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff c7fa38ae5659aa0a45a21b227b40364541124a7d 8f6c905bf75fc3e74ce38d0f5994d5e75c762c5d */db/migrate/*
version: c7fa38ae5659aa0a45a21b227b40364541124a7d vs 8f6c905bf75fc3e74ce38d0f5994d5e75c762c5d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
length: 11
length: 89
length: 100
length: 118
length: 2944
length: 2944
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 3219740408623e39b8b88093a45e29e7929cc4ad 44566c8957f10c0c1bed67f31aae52c43dadf2e2 */db/migrate/*
version: 3219740408623e39b8b88093a45e29e7929cc4ad vs 44566c8957f10c0c1bed67f31aae52c43dadf2e2
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2944
length: 2944
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 2b74b23b9113246def85fffd5e978cf8e280e041 8be97a6957376bc79262b73f4fb9e4413314e4fb */db/migrate/*
version: 2b74b23b9113246def85fffd5e978cf8e280e041 vs 8be97a6957376bc79262b73f4fb9e4413314e4fb
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 24
length: 16
length: 16
length: 869
length: 885
length: 2984
length: 2984
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff dfabb11bde3801532aa3b6b88805443cec71aa6f 3f01f1a35d44b4deffa7fb129e7b89f0edb69ce3 */db/migrate/*
version: dfabb11bde3801532aa3b6b88805443cec71aa6f vs 3f01f1a35d44b4deffa7fb129e7b89f0edb69ce3
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2984
length: 2984
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 228a60188a5aa00ecf75b03a1a627a1accb88403 9b519078bb38991ebba7c447289b6e82e5e43382 */db/migrate/*
version: 228a60188a5aa00ecf75b03a1a627a1accb88403 vs 9b519078bb38991ebba7c447289b6e82e5e43382
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 2984
length: 2984
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff b472f499210c131f2dc1a96675399733009173bc 4bd68763fded471923998830091f892d7eba1d73 */db/migrate/*
version: b472f499210c131f2dc1a96675399733009173bc vs 4bd68763fded471923998830091f892d7eba1d73
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 66
length: 23
length: 3062
length: 3083
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 263c44267a27c1b9af22c12304fbc7e9618908ea e145a1631788cf7c19e4f1705b8c45a7a181cae6 */db/migrate/*
version: 263c44267a27c1b9af22c12304fbc7e9618908ea vs e145a1631788cf7c19e4f1705b8c45a7a181cae6
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 3083
length: 3083
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 9782464284bd9c51e043526e3ac5d6f61e5dd6d6 2229e28c547929dfd4f39ce429945947e85d0b20 */db/migrate/*
version: 9782464284bd9c51e043526e3ac5d6f61e5dd6d6 vs 2229e28c547929dfd4f39ce429945947e85d0b20
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 3083
length: 3083
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 71439795e30c1aa0ee4e6a43b25016e8af4a9da8 2efe69808f94e1b5f23b3adc17a947009f7dc85b */db/migrate/*
version: 71439795e30c1aa0ee4e6a43b25016e8af4a9da8 vs 2efe69808f94e1b5f23b3adc17a947009f7dc85b
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 27
length: 3110
length: 3083
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff a347395bf1564a385ae354b7a52b5b59f42b2ec2 b3e3ed712eecbe006a6c5ee20a57e894ef38ab2e */db/migrate/*
version: a347395bf1564a385ae354b7a52b5b59f42b2ec2 vs b3e3ed712eecbe006a6c5ee20a57e894ef38ab2e
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 27
length: 21
length: 19
length: 3150
length: 3167
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 46e80c16f821fa616243036981573fb50096b690 e5c801892b52dc994cfc19573d9bd293f575db6a */db/migrate/*
version: 46e80c16f821fa616243036981573fb50096b690 vs e5c801892b52dc994cfc19573d9bd293f575db6a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 3167
length: 3167
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 87633c6fa5556ddf70d18c08dd3a7b123f97dea9 518319b20229e4ee22af3e0a986629de9c01070a */db/migrate/*
version: 87633c6fa5556ddf70d18c08dd3a7b123f97dea9 vs 518319b20229e4ee22af3e0a986629de9c01070a
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 84
length: 3083
length: 3083
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 5ba54eb8faf545fe1e66fc1927bb4fd381347435 11bc4cab0f7568c9053daa71dc6c5c693a7dccfc */db/migrate/*
version: 5ba54eb8faf545fe1e66fc1927bb4fd381347435 vs 11bc4cab0f7568c9053daa71dc6c5c693a7dccfc
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 84
length: 38
length: 11
length: 27
length: 3243
length: 3243
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 632763594338f5b7f06ec18bfdf5ef475a15eb5c 9bb548d9f57ba6307241db2f1db6c113057330c5 */db/migrate/*
version: 632763594338f5b7f06ec18bfdf5ef475a15eb5c vs 9bb548d9f57ba6307241db2f1db6c113057330c5
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 18
length: 13
length: 16
length: 3269
length: 3269
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff e146d5f713534f389ded22dbe9050cd8f1377563 63c7fbea993b9c3d0620cbcf9cf031ee66cd4615 */db/migrate/*
version: e146d5f713534f389ded22dbe9050cd8f1377563 vs 63c7fbea993b9c3d0620cbcf9cf031ee66cd4615
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 3269
length: 3269
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 5d1582d18bdb867027a0347418695ebb1ee8db08 af4f3282f0fda56927b069ab30533d8865d19c97 */db/migrate/*
version: 5d1582d18bdb867027a0347418695ebb1ee8db08 vs af4f3282f0fda56927b069ab30533d8865d19c97
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 3269
length: 3269
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff e0d69f5e01ececd2a26439442c29883df88836f5 dbd8728196b61d9aba06ccdb10bf251d244badbe */db/migrate/*
version: e0d69f5e01ececd2a26439442c29883df88836f5 vs dbd8728196b61d9aba06ccdb10bf251d244badbe
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 14
length: 21
length: 27
length: 42
length: 11
length: 14
length: 14
length: 14
length: 16
length: 13
length: 3381
length: 3381
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff c2f6749f122db76d7e92c90ebffdc1adf4d23120 b2309d44366ef4f7ba32dc4ebf2da1d1ed6b55a2 */db/migrate/*
version: c2f6749f122db76d7e92c90ebffdc1adf4d23120 vs b2309d44366ef4f7ba32dc4ebf2da1d1ed6b55a2
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 11
i 14000 length: 3392
length: 3392
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 1f99431e6eb754debe36be65dc7655d92f6c487c 86cf5ee715fac3071b80d7bc72c2a4c72d18e79d */db/migrate/*
version: 1f99431e6eb754debe36be65dc7655d92f6c487c vs 86cf5ee715fac3071b80d7bc72c2a4c72d18e79d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
new file mode 100644
index 0000000000..8f413e325f
--- /dev/null
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -0,0 +1,11 @@
+class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
+  def up
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
+  end
+
+  def down
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
+  end
+end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
new file mode 100644
index 0000000000..27aa83fa8e
--- /dev/null
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -0,0 +1,31 @@
+class SplitPricesFromVariants < ActiveRecord::Migration
+  def up
+    create_table :spree_prices do |t|
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.string :currency
+    end
+
+    Spree::Variant.all.each do |variant|
+      Spree::Price.create!(
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
+      )
+    end
+
+    remove_column :spree_variants, :price
+  end
+
+  def down
+    prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+
+    prices.each do |price|
+      ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
+    end
+    
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    drop_table :spree_prices
+  end
+end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
new file mode 100644
index 0000000000..066c0a6a17
--- /dev/null
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -0,0 +1,9 @@
+class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
+  def up
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+  end
+
+  def down
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+  end
+end
length: 13
length: 11
length: 12
length: 15
length: 11
length: 12
length: 14
length: 18
length: 14
length: 11
length: 11
length: 11
length: 11
length: 30
length: 30
length: 30
length: 30
length: 30
length: 32
length: 32
length: 32
length: 14
length: 18
length: 15
length: 66
length: 66
length: 13
length: 13
length: 13
length: 79
length: 79
length: 79
length: 79
length: 79
length: 79
length: 79
length: 66
length: 66
length: 79
length: 79
length: 79
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
cnt : 1000 length: 11
length: 11
length: 11
length: 13
length: 24
length: 17
length: 17
length: 17
length: 17
length: 17
length: 12
length: 11
length: 40
length: 40
length: 12
length: 35
length: 35
length: 539
length: 539
length: 539
length: 539
length: 539
length: 539
length: 11
length: 539
length: 539
length: 539
length: 539
length: 78
length: 27
length: 82
length: 82
length: 26
length: 83
length: 12
length: 539
length: 539
length: 539
length: 539
length: 95
length: 95
length: 11
length: 11
length: 561
length: 561
length: 117
length: 117
i 15000 length: 117
length: 117
length: 12
length: 22
length: 595
length: 595
length: 151
length: 68
length: 112
length: 14
length: 539
length: 539
length: 539
length: 653
length: 570
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 102
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 83
length: 14
length: 24
length: 20
length: 17
length: 13
length: 158
length: 75
length: 83
length: 62
length: 62
length: 12
length: 76
length: 12
length: 88
length: 88
length: 20
length: 25
length: 12
length: 18
length: 11
length: 24
length: 13
length: 24
length: 24
length: 283
length: 283
length: 317
length: 317
length: 317
length: 317
length: 317
length: 200
length: 117
length: 12
length: 11
length: 74
length: 74
length: 74
length: 74
length: 74
length: 74
length: 74
length: 19
length: 19
length: 13
length: 13
length: 13
length: 13
length: 13
length: 13
length: 32
length: 32
length: 32
length: 19
length: 13
length: 32
length: 19
length: 19
length: 19
length: 19
length: 117
length: 139
length: 22
length: 19
length: 19
i 16000 length: 118
length: 118
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 22
length: 54
length: 54
length: 54
length: 54
length: 20
length: 20
length: 20
length: 20
length: 20
length: 20
length: 20
length: 20
length: 20
length: 20
length: 20
length: 118
length: 118
length: 20
length: 20
length: 118
length: 118
length: 118
length: 118
length: 118
length: 42
length: 42
length: 42
length: 42
length: 42
length: 42
length: 42
length: 42
length: 42
length: 35
length: 35
length: 35
length: 35
length: 35
length: 35
length: 35
length: 81
length: 116
length: 116
length: 116
length: 116
length: 1224
hit line +    change_column :spree_products, :count_on_hand, :integer, null: false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, null: false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8, null: false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 6f7e4c828a6d481d2ce3c149fbb792e7e47cbce6 90bdd84ee9eb866b78efae0d7967410d23a95c99 */db/migrate/*
version: 6f7e4c828a6d481d2ce3c149fbb792e7e47cbce6 vs 90bdd84ee9eb866b78efae0d7967410d23a95c99
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
index 8f413e325f..d24c04ab5d 100644
--- a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -1,11 +1,11 @@
 class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
   def up
-    change_column :spree_products, :count_on_hand, :integer, :null => true
-    change_column :spree_variants, :count_on_hand, :integer, :null => true
+    change_column :spree_products, :count_on_hand, :integer, null: true
+    change_column :spree_variants, :count_on_hand, :integer, null: true
   end
 
   def down
-    change_column :spree_products, :count_on_hand, :integer, :null => false
-    change_column :spree_variants, :count_on_hand, :integer, :null => false
+    change_column :spree_products, :count_on_hand, :integer, null: false
+    change_column :spree_variants, :count_on_hand, :integer, null: false
   end
 end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
index 27aa83fa8e..5cc44932d5 100644
--- a/core/db/migrate/20121031162139_split_prices_from_variants.rb
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -1,16 +1,16 @@
 class SplitPricesFromVariants < ActiveRecord::Migration
   def up
     create_table :spree_prices do |t|
-      t.integer :variant_id, :null => false
-      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.integer :variant_id, null: false
+      t.decimal :amount, precision: 8, scale: 2, null: false
       t.string :currency
     end
 
     Spree::Variant.all.each do |variant|
       Spree::Price.create!(
-        :variant_id => variant.id,
-        :amount => variant[:price],
-        :currency => Spree::Config[:currency]
+        variant_id: variant.id,
+        amount: variant[:price],
+        currency: Spree::Config[:currency]
       )
     end
 
@@ -19,13 +19,13 @@ class SplitPricesFromVariants < ActiveRecord::Migration
 
   def down
     prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
-    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+    add_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8
 
     prices.each do |price|
       ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
     end
     
-    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    change_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8, null: false
     drop_table :spree_prices
   end
 end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
index 066c0a6a17..6fdb36284b 100644
--- a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -1,9 +1,9 @@
 class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
   def up
-    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: true
   end
 
   def down
-    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: false
   end
 end
length: 1224
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 90bdd84ee9eb866b78efae0d7967410d23a95c99 b984421ba91f4558613fdae74c81bf30308e9643 */db/migrate/*
version: 90bdd84ee9eb866b78efae0d7967410d23a95c99 vs b984421ba91f4558613fdae74c81bf30308e9643
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
index d24c04ab5d..8f413e325f 100644
--- a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -1,11 +1,11 @@
 class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
   def up
-    change_column :spree_products, :count_on_hand, :integer, null: true
-    change_column :spree_variants, :count_on_hand, :integer, null: true
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
   end
 
   def down
-    change_column :spree_products, :count_on_hand, :integer, null: false
-    change_column :spree_variants, :count_on_hand, :integer, null: false
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
   end
 end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
index 5cc44932d5..27aa83fa8e 100644
--- a/core/db/migrate/20121031162139_split_prices_from_variants.rb
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -1,16 +1,16 @@
 class SplitPricesFromVariants < ActiveRecord::Migration
   def up
     create_table :spree_prices do |t|
-      t.integer :variant_id, null: false
-      t.decimal :amount, precision: 8, scale: 2, null: false
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
       t.string :currency
     end
 
     Spree::Variant.all.each do |variant|
       Spree::Price.create!(
-        variant_id: variant.id,
-        amount: variant[:price],
-        currency: Spree::Config[:currency]
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
       )
     end
 
@@ -19,13 +19,13 @@ class SplitPricesFromVariants < ActiveRecord::Migration
 
   def down
     prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
-    add_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
 
     prices.each do |price|
       ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
     end
     
-    change_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8, null: false
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
     drop_table :spree_prices
   end
 end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
index 6fdb36284b..066c0a6a17 100644
--- a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -1,9 +1,9 @@
 class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
   def up
-    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: true
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
   end
 
   def down
-    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: false
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
   end
 end
length: 1224
hit line +    change_column :spree_products, :count_on_hand, :integer, null: false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, null: false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8, null: false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 0bb94a2feb1b2379443ffe6145f63a87efe0a3ff 49847585307538707dc8b87a875d1a279645d30d */db/migrate/*
version: 0bb94a2feb1b2379443ffe6145f63a87efe0a3ff vs 49847585307538707dc8b87a875d1a279645d30d
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
index 8f413e325f..d24c04ab5d 100644
--- a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -1,11 +1,11 @@
 class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
   def up
-    change_column :spree_products, :count_on_hand, :integer, :null => true
-    change_column :spree_variants, :count_on_hand, :integer, :null => true
+    change_column :spree_products, :count_on_hand, :integer, null: true
+    change_column :spree_variants, :count_on_hand, :integer, null: true
   end
 
   def down
-    change_column :spree_products, :count_on_hand, :integer, :null => false
-    change_column :spree_variants, :count_on_hand, :integer, :null => false
+    change_column :spree_products, :count_on_hand, :integer, null: false
+    change_column :spree_variants, :count_on_hand, :integer, null: false
   end
 end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
index 27aa83fa8e..5cc44932d5 100644
--- a/core/db/migrate/20121031162139_split_prices_from_variants.rb
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -1,16 +1,16 @@
 class SplitPricesFromVariants < ActiveRecord::Migration
   def up
     create_table :spree_prices do |t|
-      t.integer :variant_id, :null => false
-      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.integer :variant_id, null: false
+      t.decimal :amount, precision: 8, scale: 2, null: false
       t.string :currency
     end
 
     Spree::Variant.all.each do |variant|
       Spree::Price.create!(
-        :variant_id => variant.id,
-        :amount => variant[:price],
-        :currency => Spree::Config[:currency]
+        variant_id: variant.id,
+        amount: variant[:price],
+        currency: Spree::Config[:currency]
       )
     end
 
@@ -19,13 +19,13 @@ class SplitPricesFromVariants < ActiveRecord::Migration
 
   def down
     prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
-    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+    add_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8
 
     prices.each do |price|
       ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
     end
     
-    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    change_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8, null: false
     drop_table :spree_prices
   end
 end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
index 066c0a6a17..6fdb36284b 100644
--- a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -1,9 +1,9 @@
 class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
   def up
-    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: true
   end
 
   def down
-    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: false
   end
 end
length: 1305
hit line +    change_column :spree_products, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, :null => false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 49847585307538707dc8b87a875d1a279645d30d 3594a9a76dbf8075496c7df06db766aa5d208aba */db/migrate/*
version: 49847585307538707dc8b87a875d1a279645d30d vs 3594a9a76dbf8075496c7df06db766aa5d208aba
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
index d24c04ab5d..8f413e325f 100644
--- a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -1,11 +1,11 @@
 class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
   def up
-    change_column :spree_products, :count_on_hand, :integer, null: true
-    change_column :spree_variants, :count_on_hand, :integer, null: true
+    change_column :spree_products, :count_on_hand, :integer, :null => true
+    change_column :spree_variants, :count_on_hand, :integer, :null => true
   end
 
   def down
-    change_column :spree_products, :count_on_hand, :integer, null: false
-    change_column :spree_variants, :count_on_hand, :integer, null: false
+    change_column :spree_products, :count_on_hand, :integer, :null => false
+    change_column :spree_variants, :count_on_hand, :integer, :null => false
   end
 end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
index 5cc44932d5..27aa83fa8e 100644
--- a/core/db/migrate/20121031162139_split_prices_from_variants.rb
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -1,16 +1,16 @@
 class SplitPricesFromVariants < ActiveRecord::Migration
   def up
     create_table :spree_prices do |t|
-      t.integer :variant_id, null: false
-      t.decimal :amount, precision: 8, scale: 2, null: false
+      t.integer :variant_id, :null => false
+      t.decimal :amount, :precision => 8, :scale => 2, :null => false
       t.string :currency
     end
 
     Spree::Variant.all.each do |variant|
       Spree::Price.create!(
-        variant_id: variant.id,
-        amount: variant[:price],
-        currency: Spree::Config[:currency]
+        :variant_id => variant.id,
+        :amount => variant[:price],
+        :currency => Spree::Config[:currency]
       )
     end
 
@@ -19,13 +19,13 @@ class SplitPricesFromVariants < ActiveRecord::Migration
 
   def down
     prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
-    add_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8
+    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
 
     prices.each do |price|
       ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
     end
     
-    change_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8, null: false
+    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
     drop_table :spree_prices
   end
 end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
index 6fdb36284b..066c0a6a17 100644
--- a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -1,9 +1,9 @@
 class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
   def up
-    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: true
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
   end
 
   def down
-    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: false
+    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
   end
 end
length: 1305
hit line +    change_column :spree_products, :count_on_hand, :integer, null: false
results: 1
hit line +    change_column :spree_variants, :count_on_hand, :integer, null: false
results: 1
hit line +    change_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8, null: false
results: 2
hit line +    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: false
results: 3
cmd cd /Users/jwy/Research/spree/; git diff 3594a9a76dbf8075496c7df06db766aa5d208aba 3fc1ff388441ad331881a279a91c9a9f60490b8b */db/migrate/*
version: 3594a9a76dbf8075496c7df06db766aa5d208aba vs 3fc1ff388441ad331881a279a91c9a9f60490b8b
filename: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
con: diff --git a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
index 8f413e325f..d24c04ab5d 100644
--- a/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
+++ b/core/db/migrate/20121017010007_remove_not_null_constraint_from_products_on_hand.rb
@@ -1,11 +1,11 @@
 class RemoveNotNullConstraintFromProductsOnHand < ActiveRecord::Migration
   def up
-    change_column :spree_products, :count_on_hand, :integer, :null => true
-    change_column :spree_variants, :count_on_hand, :integer, :null => true
+    change_column :spree_products, :count_on_hand, :integer, null: true
+    change_column :spree_variants, :count_on_hand, :integer, null: true
   end
 
   def down
-    change_column :spree_products, :count_on_hand, :integer, :null => false
-    change_column :spree_variants, :count_on_hand, :integer, :null => false
+    change_column :spree_products, :count_on_hand, :integer, null: false
+    change_column :spree_variants, :count_on_hand, :integer, null: false
   end
 end
filename: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
con: diff --git a/core/db/migrate/20121031162139_split_prices_from_variants.rb b/core/db/migrate/20121031162139_split_prices_from_variants.rb
index 27aa83fa8e..5cc44932d5 100644
--- a/core/db/migrate/20121031162139_split_prices_from_variants.rb
+++ b/core/db/migrate/20121031162139_split_prices_from_variants.rb
@@ -1,16 +1,16 @@
 class SplitPricesFromVariants < ActiveRecord::Migration
   def up
     create_table :spree_prices do |t|
-      t.integer :variant_id, :null => false
-      t.decimal :amount, :precision => 8, :scale => 2, :null => false
+      t.integer :variant_id, null: false
+      t.decimal :amount, precision: 8, scale: 2, null: false
       t.string :currency
     end
 
     Spree::Variant.all.each do |variant|
       Spree::Price.create!(
-        :variant_id => variant.id,
-        :amount => variant[:price],
-        :currency => Spree::Config[:currency]
+        variant_id: variant.id,
+        amount: variant[:price],
+        currency: Spree::Config[:currency]
       )
     end
 
@@ -19,13 +19,13 @@ class SplitPricesFromVariants < ActiveRecord::Migration
 
   def down
     prices = ActiveRecord::Base.connection.execute("select variant_id, amount from spree_prices")
-    add_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8
+    add_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8
 
     prices.each do |price|
       ActiveRecord::Base.connection.execute("update spree_variants set price = #{price['amount']} where id = #{price['variant_id']}")
     end
     
-    change_column :spree_variants, :price, :decimal, :after => :sku, :scale => 2, :precision => 8, :null => false
+    change_column :spree_variants, :price, :decimal, after: :sku, scale: 2, precision: 8, null: false
     drop_table :spree_prices
   end
 end
filename: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
con: diff --git a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
index 066c0a6a17..6fdb36284b 100644
--- a/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
+++ b/core/db/migrate/20121107003422_remove_not_null_from_spree_prices_amount.rb
@@ -1,9 +1,9 @@
 class RemoveNotNullFromSpreePricesAmount < ActiveRecord::Migration
   def up
-    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => true
+    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: true
   end
 
   def down
-    change_column :spree_prices, :amount, :decimal, :precision => 8, :scale => 2, :null => false
+    change_column :spree_prices, :amount, :decimal, precision: 8, scale: 2, null: false
   end
 end
length: 13
length: 13
length: 13
length: 13
length: 13
length: 73
length: 73
length: 73
length: 73
length: 73
length: 51
length: 12
length: 82
length: 2322
length: 2394
length: 2394
length: 2394
length: 2394
length: 2394
length: 2394
length: 14
length: 12
length: 83
length: 15
length: 98
length: 98
length: 11
length: 11
length: 13
length: 13
length: 13
length: 12
length: 11
length: 68
i 17000 length: 68
length: 68
length: 14
length: 14
length: 14
length: 11
length: 35
length: 22
length: 46
length: 46
length: 46
length: 46
length: 22
length: 22
length: 44
length: 22
length: 23
length: 22
length: 22
length: 22
length: 155
length: 155
length: 155
length: 155
length: 189
length: 189
length: 189
length: 59
length: 201
length: 155
length: 155
length: 11
length: 25
length: 25
length: 11
length: 26
length: 11
length: 12
length: 12
length: 12
length: 17
length: 24
length: 11
length: 26
length: 12
length: 11
length: 11
length: 257
length: 155
length: 155
length: 257
length: 46
length: 303
length: 303
length: 17
length: 17
length: 17
length: 462
length: 155
length: 307
length: 24
length: 24
length: 24
length: 16
length: 22
length: 22
length: 26
length: 26
length: 44
length: 44
length: 11
length: 11
length: 22
length: 22
length: 22
length: 22
length: 14
length: 14
length: 382
length: 382
length: 14
length: 14
i 18000 length: 14
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 12
length: 12
length: 12
length: 17
length: 17
length: 17
length: 17
length: 17
length: 17
length: 17
length: 17
length: 17
length: 17
length: 17
length: 75
length: 61
length: 75
length: 75
length: 75
length: 75
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 11
length: 16
length: 16
length: 16
length: 16
length: 16
length: 16
length: 16
length: 18
length: 18
length: 18
length: 18
length: 18
length: 591
length: 12
length: 12
length: 12
length: 12
length: 12
length: 12
length: 12
length: 17
length: 17
length: 17
length: 21
length: 21
length: 21
i 19000 